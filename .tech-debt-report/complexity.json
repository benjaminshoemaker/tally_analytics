[{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/[id]/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/[id]/live/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/[id]/overview/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/[id]/page.tsx","messages":[{"ruleId":"complexity","severity":2,"message":"Function 'ProjectDetailPage' has a complexity of 23. Maximum allowed is 10.","line":104,"column":16,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":289,"endColumn":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useMemo, useState } from \"react\";\n\nimport OnboardingChecklist from \"../../../../components/dashboard/onboarding-checklist\";\nimport QuotaDisplay from \"../../../../components/dashboard/quota-display\";\nimport Skeleton, { SkeletonList } from \"../../../../components/dashboard/skeleton\";\nimport StatusBadge from \"../../../../components/dashboard/status-badge\";\nimport { useProject } from \"../../../../lib/hooks/use-project\";\nimport type { UserPlan } from \"../../../../lib/stripe/plans\";\n\ntype RegenerateState = {\n  status: \"idle\" | \"loading\" | \"success\" | \"error\";\n  message: string;\n  retryAfter?: number;\n};\n\nfunction canRegenerate(status: string): boolean {\n  return status === \"analysis_failed\" || status === \"pr_closed\" || status === \"unsupported\";\n}\n\nfunction shouldShowQuota(status: string): boolean {\n  return status === \"pr_pending\" || status === \"active\";\n}\n\ntype StatusCardConfig = {\n  title: string;\n  description: string;\n  bgClass: string;\n  borderClass: string;\n  iconClass: string;\n};\n\nconst STATUS_CARD_CONFIG: Record<string, StatusCardConfig> = {\n  unsupported: {\n    title: \"Repository Not Supported\",\n    description:\n      \"This repository may use an unsupported framework or structure. Click 'Re-run Analysis' to try again after making changes to your repository.\",\n    bgClass: \"bg-amber-50\",\n    borderClass: \"border-amber-200\",\n    iconClass: \"text-amber-500\",\n  },\n  analysis_failed: {\n    title: \"Analysis Failed\",\n    description:\n      \"Something went wrong during analysis. This could be a temporary issue. Click 'Re-run Analysis' to try again.\",\n    bgClass: \"bg-red-50\",\n    borderClass: \"border-red-200\",\n    iconClass: \"text-red-500\",\n  },\n  pr_closed: {\n    title: \"Pull Request Closed\",\n    description:\n      \"The analytics PR was closed without merging. Click 'Re-run Analysis' to generate a new PR.\",\n    bgClass: \"bg-slate-50\",\n    borderClass: \"border-slate-200\",\n    iconClass: \"text-slate-400\",\n  },\n};\n\nfunction StatusCard({ status }: { status: string }) {\n  const config = STATUS_CARD_CONFIG[status];\n  if (!config) return null;\n\n  return (\n    <div className={`rounded-lg border ${config.borderClass} ${config.bgClass} p-4`}>\n      <div className=\"flex items-start gap-3\">\n        <div className={`mt-0.5 ${config.iconClass}`}>\n          <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n            <path\n              d=\"M10 6v4m0 4h.01M19 10a9 9 0 11-18 0 9 9 0 0118 0z\"\n              stroke=\"currentColor\"\n              strokeWidth=\"1.5\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n          </svg>\n        </div>\n        <div>\n          <h3 className=\"text-sm font-semibold text-warm-900\">{config.title}</h3>\n          <p className=\"mt-1 text-sm text-warm-600\">{config.description}</p>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction ExternalLinkIcon() {\n  return (\n    <svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"none\" className=\"inline-block\">\n      <path\n        d=\"M12 8.667V12.667C12 13.0203 11.8595 13.3594 11.6095 13.6095C11.3594 13.8595 11.0203 14 10.667 14H3.333C2.97971 14 2.64057 13.8595 2.39052 13.6095C2.14048 13.3594 2 13.0203 2 12.667V5.333C2 4.97971 2.14048 4.64057 2.39052 4.39052C2.64057 4.14048 2.97971 4 3.333 4H7.333\"\n        stroke=\"currentColor\"\n        strokeWidth=\"1.5\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n      <path d=\"M10 2H14V6\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n      <path d=\"M6.667 9.333L14 2\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n    </svg>\n  );\n}\n\nexport default function ProjectDetailPage({ params }: { params: { id: string } }) {\n  const projectId = params.id;\n  const projectQuery = useProject(projectId);\n\n  const [regenerateState, setRegenerateState] = useState<RegenerateState>({ status: \"idle\", message: \"\" });\n  const [optimisticStatus, setOptimisticStatus] = useState<string | null>(null);\n  const [retryCountdown, setRetryCountdown] = useState<number>(0);\n\n  const project = useMemo(() => {\n    const data = projectQuery.data as null | { project?: unknown };\n    return (data?.project as null | Record<string, unknown>) ?? null;\n  }, [projectQuery.data]);\n\n  const userPlan: UserPlan = useMemo(() => {\n    const plan = (projectQuery.data as null | Record<string, unknown>)?.userPlan;\n    return plan === \"free\" || plan === \"pro\" || plan === \"team\" ? plan : \"pro\";\n  }, [projectQuery.data]);\n\n  // Auto-dismiss success message after 5 seconds\n  useEffect(() => {\n    if (regenerateState.status === \"success\") {\n      const timer = setTimeout(() => {\n        setRegenerateState({ status: \"idle\", message: \"\" });\n      }, 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [regenerateState.status]);\n\n  // Rate limit countdown timer\n  useEffect(() => {\n    if (retryCountdown > 0) {\n      const timer = setTimeout(() => {\n        setRetryCountdown((prev) => prev - 1);\n      }, 1000);\n      return () => clearTimeout(timer);\n    } else if (retryCountdown === 0 && regenerateState.status === \"error\" && regenerateState.retryAfter) {\n      setRegenerateState({ status: \"idle\", message: \"\" });\n    }\n  }, [retryCountdown, regenerateState.status, regenerateState.retryAfter]);\n\n  // Clear optimistic status when real status updates to analyzing\n  useEffect(() => {\n    const realStatus = String(project?.status ?? \"\");\n    if (realStatus === \"analyzing\" && optimisticStatus === \"analyzing\") {\n      setOptimisticStatus(null);\n    }\n  }, [project?.status, optimisticStatus]);\n\n  async function onRegenerate() {\n    setRegenerateState({ status: \"loading\", message: \"\" });\n    setOptimisticStatus(\"analyzing\");\n\n    try {\n      const response = await fetch(`/api/projects/${encodeURIComponent(projectId)}/regenerate`, { method: \"POST\" });\n      const body = (await response.json().catch(() => null)) as null | { success?: boolean; message?: string };\n\n      if (!response.ok || !body?.success) {\n        setOptimisticStatus(null);\n\n        if (response.status === 429) {\n          const retrySeconds = 300; // 5 minutes\n          setRetryCountdown(retrySeconds);\n          setRegenerateState({\n            status: \"error\",\n            message: `Rate limited. Try again in ${Math.ceil(retrySeconds / 60)} minutes.`,\n            retryAfter: retrySeconds,\n          });\n        } else {\n          setRegenerateState({ status: \"error\", message: body?.message ?? \"Unable to regenerate.\" });\n        }\n        return;\n      }\n\n      setRegenerateState({\n        status: \"success\",\n        message: \"Analysis started — this page will update automatically.\",\n      });\n      await projectQuery.refetch();\n    } catch {\n      setOptimisticStatus(null);\n      setRegenerateState({ status: \"error\", message: \"Unable to regenerate.\" });\n    }\n  }\n\n  if (projectQuery.isPending) {\n    return (\n      <div className=\"flex flex-col gap-6\">\n        <div className=\"rounded-lg border border-slate-200 bg-white p-4 shadow-sm\">\n          <Skeleton className=\"h-4 w-20\" />\n          <div className=\"mt-3 flex items-center justify-between gap-4\">\n            <Skeleton className=\"h-4 w-24\" />\n            <Skeleton className=\"h-4 w-16\" />\n          </div>\n          <Skeleton className=\"mt-3 h-2 w-full\" />\n        </div>\n        <SkeletonList />\n      </div>\n    );\n  }\n\n  if (projectQuery.isError) {\n    return (\n      <div className=\"rounded-lg border border-red-200 bg-red-50 p-4\">\n        <p className=\"text-sm text-red-700\">Unable to load project. Please try again.</p>\n      </div>\n    );\n  }\n\n  const realStatus = String(project?.status ?? \"\");\n  const displayStatus = optimisticStatus ?? realStatus;\n  const prUrl = typeof project?.prUrl === \"string\" ? (project.prUrl as string) : null;\n  const lastEventAt = typeof project?.lastEventAt === \"string\" ? (project.lastEventAt as string) : null;\n  const quotaLimit = Number((projectQuery.data as Record<string, unknown>)?.quotaLimit ?? 0);\n  const quotaUsed = Number((projectQuery.data as Record<string, unknown>)?.quotaUsed ?? 0);\n  const isOverQuota = Boolean((projectQuery.data as Record<string, unknown>)?.isOverQuota);\n\n  const showRerunButton = canRegenerate(realStatus) && !optimisticStatus;\n  const isRateLimited = retryCountdown > 0;\n\n  return (\n    <div className=\"flex flex-col gap-6\">\n      {/* Status Badge with optimistic update */}\n      {optimisticStatus && (\n        <div className=\"flex items-center gap-2\">\n          <StatusBadge status={displayStatus} />\n          <span className=\"text-sm text-warm-500\">Updating...</span>\n        </div>\n      )}\n\n      {/* Status-specific empty state card */}\n      {!optimisticStatus && canRegenerate(realStatus) && <StatusCard status={realStatus} />}\n\n      {/* Quick Actions */}\n      <div className=\"flex flex-wrap items-center gap-3\">\n        {prUrl && (\n          <a\n            href={prUrl}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            className=\"inline-flex items-center gap-1.5 rounded-md border border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm transition-colors hover:bg-slate-50\"\n          >\n            View PR <ExternalLinkIcon />\n          </a>\n        )}\n\n        {showRerunButton && (\n          <button\n            type=\"button\"\n            onClick={onRegenerate}\n            disabled={regenerateState.status === \"loading\" || isRateLimited}\n            className=\"inline-flex items-center gap-1.5 rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-slate-800 disabled:opacity-50\"\n          >\n            {regenerateState.status === \"loading\" ? \"Re-running…\" : \"Re-run Analysis\"}\n          </button>\n        )}\n      </div>\n\n      {/* Feedback messages */}\n      {regenerateState.message && (\n        <div\n          className={[\n            \"rounded-md border px-3 py-2 text-sm flex items-center justify-between\",\n            regenerateState.status === \"error\"\n              ? \"border-red-200 bg-red-50 text-red-700\"\n              : \"border-emerald-200 bg-emerald-50 text-emerald-700\",\n          ].join(\" \")}\n        >\n          <span>{regenerateState.message}</span>\n          {isRateLimited && (\n            <span className=\"ml-2 font-mono text-xs\">\n              {Math.floor(retryCountdown / 60)}:{String(retryCountdown % 60).padStart(2, \"0\")}\n            </span>\n          )}\n        </div>\n      )}\n\n      {/* QuotaDisplay only for relevant states */}\n      {shouldShowQuota(displayStatus) && (\n        <QuotaDisplay used={quotaUsed} limit={quotaLimit} isOverQuota={isOverQuota} userPlan={userPlan} />\n      )}\n\n      {/* OnboardingChecklist only when PR exists and not active */}\n      {displayStatus !== \"active\" && prUrl && <OnboardingChecklist project={{ status: displayStatus, prUrl, lastEventAt }} />}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/[id]/sessions/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/settings/page.tsx","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'SettingsPage' has a complexity of 11. Maximum allowed is 10.","line":10,"column":16,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":121,"endColumn":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { and, eq, gt } from \"drizzle-orm\";\nimport { cookies } from \"next/headers\";\nimport React from \"react\";\n\nimport { SESSION_COOKIE_NAME } from \"../../../lib/auth/cookies\";\nimport { db } from \"../../../lib/db/client\";\nimport { sessions, users } from \"../../../lib/db/schema\";\nimport { StripeReconcileClient } from \"./stripe-reconcile-client\";\n\nexport default async function SettingsPage() {\n  const sessionId = cookies().get(SESSION_COOKIE_NAME)?.value ?? null;\n  if (!sessionId) {\n    return <p className=\"text-sm text-warm-700\">Unauthorized.</p>;\n  }\n\n  const now = new Date();\n  const sessionRows = await db\n    .select({ userId: sessions.userId })\n    .from(sessions)\n    .where(and(eq(sessions.id, sessionId), gt(sessions.expiresAt, now)));\n\n  const userId = sessionRows[0]?.userId ?? null;\n  if (!userId) {\n    return <p className=\"text-sm text-warm-700\">Unauthorized.</p>;\n  }\n\n  const userRows = await db\n    .select({\n      email: users.email,\n      plan: users.plan,\n      stripeSubscriptionStatus: users.stripeSubscriptionStatus,\n      stripeCancelAtPeriodEnd: users.stripeCancelAtPeriodEnd,\n      stripeCurrentPeriodEnd: users.stripeCurrentPeriodEnd,\n    })\n    .from(users)\n    .where(eq(users.id, userId));\n  const user = userRows[0];\n  if (!user) return <p className=\"text-sm text-warm-700\">Unauthorized.</p>;\n\n  return (\n    <div className=\"flex w-full flex-col gap-6\">\n      <header className=\"flex flex-col gap-2 opacity-0 animate-fade-in\">\n        <h1 className=\"font-display text-2xl font-semibold tracking-tight text-warm-900\">Account settings</h1>\n        <p className=\"text-sm text-warm-500\">Manage your account.</p>\n      </header>\n\n      <section className=\"rounded-lg border border-warm-200 bg-white p-4 shadow-warm opacity-0 animate-fade-in stagger-1\">\n        <StripeReconcileClient />\n        <dl className=\"grid gap-3 text-sm\">\n          <div className=\"flex items-center justify-between gap-4\">\n            <dt className=\"text-warm-500\">Email</dt>\n            <dd className=\"font-medium text-warm-900\">{user.email}</dd>\n          </div>\n          <div className=\"flex items-center justify-between gap-4\">\n            <dt className=\"text-warm-500\">Plan</dt>\n            <dd className=\"font-medium text-warm-900\">{user.plan.charAt(0).toUpperCase() + user.plan.slice(1)}</dd>\n          </div>\n          {user.stripeSubscriptionStatus ? (\n            <div className=\"flex items-center justify-between gap-4\">\n              <dt className=\"text-warm-500\">Billing status</dt>\n              <dd className=\"font-medium text-warm-900\">\n                {user.stripeSubscriptionStatus.charAt(0).toUpperCase() + user.stripeSubscriptionStatus.slice(1)}\n              </dd>\n            </div>\n          ) : null}\n          {user.stripeCurrentPeriodEnd ? (\n            <div className=\"flex items-center justify-between gap-4\">\n              <dt className=\"text-warm-500\">Current period end</dt>\n              <dd className=\"font-medium text-warm-900\">{user.stripeCurrentPeriodEnd.toISOString().slice(0, 10)}</dd>\n            </div>\n          ) : null}\n          {typeof user.stripeCancelAtPeriodEnd === \"boolean\" ? (\n            <div className=\"flex items-center justify-between gap-4\">\n              <dt className=\"text-warm-500\">Cancel at period end</dt>\n              <dd className=\"font-medium text-warm-900\">{user.stripeCancelAtPeriodEnd ? \"Yes\" : \"No\"}</dd>\n            </div>\n          ) : null}\n        </dl>\n      </section>\n\n      <section className=\"rounded-lg border border-warm-200 bg-white p-4 shadow-warm opacity-0 animate-fade-in stagger-2\">\n        <h2 className=\"font-display text-sm font-semibold text-warm-900\">Billing</h2>\n        <p className=\"mt-1 text-sm text-warm-500\">Upgrade, downgrade, or manage your subscription.</p>\n\n        <div className=\"mt-4 flex flex-wrap items-center gap-3\">\n          {user.plan === \"free\" ? (\n            <>\n              <form action=\"/api/stripe/checkout\" method=\"post\">\n                <input type=\"hidden\" name=\"plan\" value=\"pro\" />\n                <button type=\"submit\" className=\"group flex items-center gap-2 rounded-lg bg-brand-500 px-4 py-2 text-sm font-medium text-white shadow-warm transition-all hover:bg-brand-600 hover:shadow-warm-md active:scale-[0.98]\">\n                  Upgrade to Pro\n                  <svg className=\"size-4 transition-transform group-hover:translate-x-0.5\" viewBox=\"0 0 16 16\" fill=\"none\">\n                    <path d=\"M3 8h10M9 4l4 4-4 4\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                  </svg>\n                </button>\n              </form>\n              <form action=\"/api/stripe/checkout\" method=\"post\">\n                <input type=\"hidden\" name=\"plan\" value=\"team\" />\n                <button type=\"submit\" className=\"group flex items-center gap-2 rounded-lg border border-warm-200 bg-white px-4 py-2 text-sm font-medium text-warm-900 shadow-warm transition-all hover:border-warm-300 hover:bg-warm-50 hover:shadow-warm-md active:scale-[0.98]\">\n                  Upgrade to Team\n                  <svg className=\"size-4 transition-transform group-hover:translate-x-0.5\" viewBox=\"0 0 16 16\" fill=\"none\">\n                    <path d=\"M3 8h10M9 4l4 4-4 4\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                  </svg>\n                </button>\n              </form>\n            </>\n          ) : (\n            <form action=\"/api/stripe/portal\" method=\"post\">\n              <button type=\"submit\" className=\"group flex items-center gap-2 rounded-lg bg-brand-500 px-4 py-2 text-sm font-medium text-white shadow-warm transition-all hover:bg-brand-600 hover:shadow-warm-md active:scale-[0.98]\">\n                Manage billing\n                <svg className=\"size-4 transition-transform group-hover:translate-x-0.5\" viewBox=\"0 0 16 16\" fill=\"none\">\n                  <path d=\"M3 8h10M9 4l4 4-4 4\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                </svg>\n              </button>\n            </form>\n          )}\n        </div>\n      </section>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/settings/stripe-reconcile-client.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/docs/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/docs/sdk/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/docs/setup/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/pricing/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/privacy/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/terms/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/auth/e2e-login/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/auth/github/callback/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/auth/github/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/auth/logout/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/github/callback/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/[id]/analytics/live/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'GET' has a complexity of 12. Maximum allowed is 10.","line":41,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":114,"endColumn":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { and, eq } from \"drizzle-orm\";\n\nimport { getUserFromRequest } from \"../../../../../../lib/auth/get-user\";\nimport { db } from \"../../../../../../lib/db/client\";\nimport { projects } from \"../../../../../../lib/db/schema\";\nimport { createTinybirdClientFromEnv, tinybirdSql } from \"../../../../../../lib/tinybird/client\";\n\ntype LiveFeedResponse = {\n  events: Array<{\n    id: string;\n    eventType: string;\n    path: string;\n    referrer: string | null;\n    timestamp: string;\n    relativeTime: string;\n  }>;\n  hasMore: boolean;\n};\n\nfunction clamp(n: number, min: number, max: number): number {\n  return Math.max(min, Math.min(max, n));\n}\n\nfunction escapeSqlString(value: string): string {\n  return value.replaceAll(\"'\", \"''\");\n}\n\nfunction toTinybirdDateTime64String(date: Date): string {\n  return date.toISOString().replace(\"T\", \" \").replace(\"Z\", \"\");\n}\n\nfunction normalizeTimestamp(value: unknown): string {\n  const raw = String(value ?? \"\");\n  if (!raw) return \"\";\n  if (raw.includes(\"T\")) return raw;\n\n  const iso = raw.replace(\" \", \"T\");\n  return iso.endsWith(\"Z\") ? iso : `${iso}Z`;\n}\n\nexport async function GET(\n  request: Request,\n  context: { params: Promise<{ id: string }> | { id: string } },\n): Promise<Response> {\n  const user = await getUserFromRequest(request);\n  if (!user) return Response.json({ error: \"Unauthorized\" }, { status: 401 });\n\n  const params = \"then\" in context.params ? await context.params : context.params;\n  const projectId = params.id;\n  if (!projectId) return Response.json({ error: \"Missing project id\" }, { status: 400 });\n\n  const ownedRows = await db\n    .select({ id: projects.id })\n    .from(projects)\n    .where(and(eq(projects.id, projectId), eq(projects.userId, user.id)));\n\n  if (!ownedRows[0]) return Response.json({ error: \"Project not found\" }, { status: 404 });\n\n  const url = new URL(request.url);\n  const limitRaw = url.searchParams.get(\"limit\");\n  const limit = clamp(Number.parseInt(limitRaw ?? \"20\", 10) || 20, 1, 100);\n  const sinceRaw = url.searchParams.get(\"since\") ?? \"\";\n  const sinceDate = sinceRaw ? new Date(sinceRaw) : null;\n  const since = sinceDate && !Number.isNaN(sinceDate.getTime()) ? toTinybirdDateTime64String(sinceDate) : \"\";\n  const sinceFilter = since || \"2024-01-01 00:00:00.000\";\n\n  const client = createTinybirdClientFromEnv();\n  const projectIdSql = escapeSqlString(projectId);\n  const sinceSql = escapeSqlString(sinceFilter);\n\n  const result = await tinybirdSql<{\n    event_type: string;\n    path: string;\n    referrer: string;\n    timestamp: string;\n    relative_time: string;\n  }>(\n    client,\n    `\n      SELECT\n        event_type,\n        ifNull(path, '') AS path,\n        ifNull(referrer, '') AS referrer,\n        toString(e.timestamp) AS timestamp,\n        formatReadableTimeDelta(now() - toDateTime(e.timestamp)) AS relative_time\n      FROM events AS e\n      WHERE e.project_id = '${projectIdSql}'\n      AND e.timestamp > toDateTime64('${sinceSql}', 3)\n      ORDER BY e.timestamp DESC\n      LIMIT ${limit}\n    `.trim(),\n  );\n\n  const data = result.data;\n  const events: LiveFeedResponse[\"events\"] = data.map((row, index) => {\n    const typed = row as Record<string, unknown>;\n    const timestamp = normalizeTimestamp(typed.timestamp);\n    const referrer = typeof typed.referrer === \"string\" && typed.referrer.length > 0 ? typed.referrer : null;\n\n    return {\n      id: `${timestamp}-${index}`,\n      eventType: String(typed.event_type ?? \"\"),\n      path: String(typed.path ?? \"\"),\n      referrer,\n      timestamp,\n      relativeTime: String(typed.relative_time ?? \"\"),\n    };\n  });\n\n  return Response.json(\n    { events, hasMore: events.length >= limit } satisfies LiveFeedResponse,\n    { status: 200 },\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/[id]/analytics/overview/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/[id]/analytics/sessions/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/[id]/regenerate/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/[id]/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'GET' has a complexity of 14. Maximum allowed is 10.","line":66,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":131,"endColumn":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { and, eq } from \"drizzle-orm\";\n\nimport { getUserFromRequest } from \"../../../../lib/auth/get-user\";\nimport { db } from \"../../../../lib/db/client\";\nimport { projects, users } from \"../../../../lib/db/schema\";\nimport { createTinybirdClientFromEnv, tinybirdSql } from \"../../../../lib/tinybird/client\";\n\nfunction escapeSqlString(value: string): string {\n  return value.replaceAll(\"'\", \"''\");\n}\n\nfunction normalizeTimestamp(value: unknown): string | null {\n  const raw = String(value ?? \"\");\n  if (!raw) return null;\n  if (raw.includes(\"T\")) return raw.endsWith(\"Z\") ? raw : `${raw}Z`;\n\n  const iso = raw.replace(\" \", \"T\");\n  return iso.endsWith(\"Z\") ? iso : `${iso}Z`;\n}\n\nasync function fetchTinybirdLastEventAt(projectId: string): Promise<string | null> {\n  const client = createTinybirdClientFromEnv();\n  const projectIdSql = escapeSqlString(projectId);\n\n  const result = await tinybirdSql<{ last_event_at: string }>(\n    client,\n    `\n      SELECT\n        toString(max(timestamp)) AS last_event_at\n      FROM events\n      WHERE project_id = '${projectIdSql}'\n      GROUP BY project_id\n      LIMIT 1\n    `.trim(),\n  );\n\n  return normalizeTimestamp(result.data[0]?.last_event_at ?? null);\n}\n\nconst PLAN_LIMITS = {\n  free: 10_000,\n  pro: 100_000,\n  team: 1_000_000,\n} as const;\n\ntype ProjectDetailResponse = {\n  project: {\n    id: string;\n    githubRepoFullName: string;\n    status: string;\n    prNumber: number | null;\n    prUrl: string | null;\n    detectedFramework: string | null;\n    detectedAnalytics: string[];\n    eventsThisMonth: number;\n    lastEventAt: string | null;\n    createdAt: string;\n    updatedAt: string;\n  };\n  quotaLimit: number;\n  quotaUsed: number;\n  isOverQuota: boolean;\n  userPlan: string;\n};\n\nexport async function GET(\n  request: Request,\n  context: { params: Promise<{ id: string }> | { id: string } },\n): Promise<Response> {\n  const user = await getUserFromRequest(request);\n  if (!user) return Response.json({ error: \"Unauthorized\" }, { status: 401 });\n\n  const params = \"then\" in context.params ? await context.params : context.params;\n  const projectId = params.id;\n  if (!projectId) return Response.json({ error: \"Missing project id\" }, { status: 400 });\n\n  const projectRows = await db\n    .select({\n      id: projects.id,\n      githubRepoFullName: projects.githubRepoFullName,\n      status: projects.status,\n      prNumber: projects.prNumber,\n      prUrl: projects.prUrl,\n      detectedFramework: projects.detectedFramework,\n      detectedAnalytics: projects.detectedAnalytics,\n      eventsThisMonth: projects.eventsThisMonth,\n      lastEventAt: projects.lastEventAt,\n      createdAt: projects.createdAt,\n      updatedAt: projects.updatedAt,\n    })\n    .from(projects)\n    .where(and(eq(projects.id, projectId), eq(projects.userId, user.id)));\n\n  const project = projectRows[0];\n  if (!project) return Response.json({ error: \"Project not found\" }, { status: 404 });\n\n  const userRows = await db.select({ plan: users.plan }).from(users).where(eq(users.id, user.id));\n  const plan = userRows[0]?.plan ?? \"free\";\n  const quotaLimit = PLAN_LIMITS[plan as keyof typeof PLAN_LIMITS] ?? PLAN_LIMITS.free;\n  const quotaUsed = Number(project.eventsThisMonth);\n  const isOverQuota = quotaUsed >= quotaLimit;\n\n  let lastEventAt: string | null = null;\n  try {\n    lastEventAt = await fetchTinybirdLastEventAt(project.id);\n  } catch {\n    lastEventAt = null;\n  }\n\n  const responseBody: ProjectDetailResponse = {\n    project: {\n      id: project.id,\n      githubRepoFullName: project.githubRepoFullName,\n      status: project.status,\n      prNumber: project.prNumber ?? null,\n      prUrl: project.prUrl ?? null,\n      detectedFramework: project.detectedFramework ?? null,\n      detectedAnalytics: project.detectedAnalytics ?? [],\n      eventsThisMonth: quotaUsed,\n      lastEventAt: lastEventAt ?? (project.lastEventAt ? project.lastEventAt.toISOString() : null),\n      createdAt: project.createdAt.toISOString(),\n      updatedAt: project.updatedAt.toISOString(),\n    },\n    quotaLimit,\n    quotaUsed,\n    isOverQuota,\n    userPlan: String(plan),\n  };\n\n  return Response.json(responseBody);\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/stripe/checkout/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'POST' has a complexity of 12. Maximum allowed is 10.","line":31,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":117,"endColumn":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { eq } from \"drizzle-orm\";\nimport { NextResponse } from \"next/server\";\n\nimport { validateSession } from \"../../../../lib/auth/session\";\nimport { getAppUrl } from \"../../../../lib/app-url\";\nimport { db } from \"../../../../lib/db/client\";\nimport { users } from \"../../../../lib/db/schema\";\nimport { getPriceIdForPlan } from \"../../../../lib/stripe/constants\";\nimport { getStripe } from \"../../../../lib/stripe/client\";\nimport { isPaidPlan, type PaidPlan } from \"../../../../lib/stripe/plans\";\n\nconst ACTIVE_SUBSCRIPTION_STATUSES = new Set([\"active\", \"trialing\", \"past_due\", \"unpaid\"]);\n\nfunction normalizeBaseUrl(url: string): string {\n  return url.endsWith(\"/\") ? url.slice(0, -1) : url;\n}\n\nasync function createBillingPortalUrl(stripeCustomerId: string): Promise<string | null> {\n  const stripe = getStripe();\n  const appUrl = normalizeBaseUrl(getAppUrl());\n\n  const portalSession = await stripe.billingPortal.sessions.create({\n    customer: stripeCustomerId,\n    return_url: `${appUrl}/settings`,\n    configuration: process.env.STRIPE_BILLING_PORTAL_CONFIG_ID || undefined,\n  });\n\n  return typeof portalSession.url === \"string\" && portalSession.url.length > 0 ? portalSession.url : null;\n}\n\nexport async function POST(request: Request): Promise<Response> {\n  const session = await validateSession(request);\n  if (!session) {\n    return Response.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  let formData: FormData;\n  try {\n    formData = await request.formData();\n  } catch {\n    return Response.json({ error: \"Invalid request\" }, { status: 400 });\n  }\n\n  const planRaw = formData.get(\"plan\");\n  if (!isPaidPlan(planRaw)) {\n    return Response.json({ error: \"Invalid plan\" }, { status: 400 });\n  }\n  const plan: PaidPlan = planRaw;\n\n  const rows = await db\n    .select({ id: users.id, email: users.email, plan: users.plan, stripeCustomerId: users.stripeCustomerId })\n    .from(users)\n    .where(eq(users.id, session.userId));\n\n  const user = rows[0];\n  if (!user) {\n    return Response.json({ error: \"User not found\" }, { status: 404 });\n  }\n\n  const stripe = getStripe();\n\n  let stripeCustomerId = user.stripeCustomerId ?? null;\n  if (!stripeCustomerId) {\n    try {\n      const customer = await stripe.customers.create({ email: user.email, metadata: { userId: user.id } });\n      stripeCustomerId = customer.id;\n\n      await db.update(users).set({ stripeCustomerId }).where(eq(users.id, user.id));\n    } catch (error) {\n      console.error(\"stripe.checkout.customer_create_failed\", { userId: user.id, error });\n      return Response.json({ error: \"Failed to start checkout\" }, { status: 500 });\n    }\n  }\n\n  try {\n    const subscriptions = await stripe.subscriptions.list({ customer: stripeCustomerId, status: \"all\", limit: 10 });\n    const hasActiveSubscription = subscriptions.data.some((subscription) =>\n      ACTIVE_SUBSCRIPTION_STATUSES.has(subscription.status),\n    );\n\n    if (hasActiveSubscription) {\n      const manageUrl = await createBillingPortalUrl(stripeCustomerId);\n      return Response.json({ error: \"Subscription already exists\", manageUrl }, { status: 409 });\n    }\n  } catch (error) {\n    console.error(\"stripe.checkout.subscription_check_failed\", { userId: user.id, stripeCustomerId, error });\n    return Response.json({ error: \"Failed to start checkout\" }, { status: 500 });\n  }\n\n  const appUrl = normalizeBaseUrl(getAppUrl());\n\n  try {\n    const checkoutSession = await stripe.checkout.sessions.create({\n      mode: \"subscription\",\n      customer: stripeCustomerId,\n      line_items: [{ price: getPriceIdForPlan(plan), quantity: 1 }],\n      subscription_data: {\n        metadata: {\n          userId: user.id,\n          plan,\n        },\n      },\n      success_url: `${appUrl}/settings?success=true&checkout_session_id={CHECKOUT_SESSION_ID}`,\n      cancel_url: `${appUrl}/settings`,\n    });\n\n    if (!checkoutSession.url) {\n      console.error(\"stripe.checkout.session_missing_url\", { userId: user.id, stripeCustomerId, sessionId: checkoutSession.id });\n      return Response.json({ error: \"Failed to start checkout\" }, { status: 500 });\n    }\n\n    return NextResponse.redirect(checkoutSession.url, { status: 303 });\n  } catch (error) {\n    console.error(\"stripe.checkout.session_create_failed\", { userId: user.id, stripeCustomerId, error });\n    return Response.json({ error: \"Failed to start checkout\" }, { status: 500 });\n  }\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/stripe/portal/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/stripe/reconcile/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'POST' has a complexity of 24. Maximum allowed is 10.","line":43,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":127,"endColumn":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { eq } from \"drizzle-orm\";\n\nimport { validateSession } from \"../../../../lib/auth/session\";\nimport { db } from \"../../../../lib/db/client\";\nimport { users } from \"../../../../lib/db/schema\";\nimport { getPlanForPriceId } from \"../../../../lib/stripe/constants\";\nimport { getStripe } from \"../../../../lib/stripe/client\";\n\ntype ReconcileBody = {\n  checkout_session_id?: unknown;\n};\n\nfunction getExpandedId(value: unknown): string | null {\n  if (typeof value === \"string\" && value.length > 0) return value;\n  if (value && typeof value === \"object\" && \"id\" in value && typeof (value as { id?: unknown }).id === \"string\") {\n    const id = (value as { id: string }).id;\n    return id.length > 0 ? id : null;\n  }\n  return null;\n}\n\nfunction getUnixSecondsDate(value: unknown): Date | null {\n  let seconds: number | null = null;\n\n  if (typeof value === \"number\" && Number.isFinite(value)) {\n    seconds = Math.floor(value);\n  } else if (typeof value === \"string\" && value.trim().length > 0) {\n    const parsed = Number(value);\n    if (Number.isFinite(parsed)) {\n      seconds = Math.floor(parsed);\n    }\n  } else if (typeof value === \"bigint\") {\n    const parsed = Number(value);\n    if (Number.isSafeInteger(parsed)) {\n      seconds = parsed;\n    }\n  }\n\n  if (seconds === null) return null;\n  return new Date(seconds * 1000);\n}\n\nexport async function POST(request: Request): Promise<Response> {\n  const session = await validateSession(request);\n  if (!session) {\n    return Response.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n\n  let json: unknown;\n  try {\n    json = await request.json();\n  } catch {\n    return Response.json({ error: \"Invalid JSON body\" }, { status: 400 });\n  }\n\n  const body = json as ReconcileBody;\n  const checkoutSessionId = typeof body.checkout_session_id === \"string\" ? body.checkout_session_id : null;\n  if (!checkoutSessionId) {\n    return Response.json({ error: \"Missing checkout_session_id\" }, { status: 400 });\n  }\n\n  const userRows = await db\n    .select({ id: users.id, plan: users.plan, stripeCustomerId: users.stripeCustomerId })\n    .from(users)\n    .where(eq(users.id, session.userId));\n  const user = userRows[0];\n  if (!user) {\n    return Response.json({ error: \"User not found\" }, { status: 404 });\n  }\n\n  const stripe = getStripe();\n\n  let checkoutSession: any;\n  try {\n    checkoutSession = await stripe.checkout.sessions.retrieve(checkoutSessionId, {\n      expand: [\"subscription\", \"customer\"],\n    });\n  } catch (error) {\n    console.error(\"stripe.reconcile.checkout_session_retrieve_failed\", { checkoutSessionId, error });\n    return Response.json({ error: \"Invalid checkout_session_id\" }, { status: 400 });\n  }\n\n  const customerId = getExpandedId(checkoutSession?.customer);\n  const subscription = checkoutSession?.subscription;\n  const subscriptionId = getExpandedId(subscription);\n\n  const belongsToCustomer = !!(customerId && user.stripeCustomerId && customerId === user.stripeCustomerId);\n  const belongsToUserMetadata = subscription?.metadata?.userId === user.id;\n  if (!belongsToCustomer && !belongsToUserMetadata) {\n    return Response.json({ error: \"Forbidden\" }, { status: 403 });\n  }\n\n  if (!subscriptionId || !subscription || typeof subscription !== \"object\") {\n    return Response.json({ error: \"Checkout session missing subscription\" }, { status: 400 });\n  }\n\n  const priceId = subscription?.items?.data?.[0]?.price?.id;\n  const mappedPlan = typeof priceId === \"string\" ? getPlanForPriceId(priceId) : null;\n\n  const newPlan = mappedPlan ?? user.plan;\n\n  const cancelAtDate = getUnixSecondsDate(subscription.cancel_at);\n  const currentPeriodEndDate = getUnixSecondsDate(subscription.current_period_end) ?? cancelAtDate;\n  const hasScheduledCancellation = !!cancelAtDate && (subscription.canceled_at === null || subscription.canceled_at === undefined);\n  const cancelAtPeriodEnd =\n    hasScheduledCancellation || typeof subscription.cancel_at_period_end !== \"boolean\" ? hasScheduledCancellation : subscription.cancel_at_period_end;\n\n  const updatedRows = await db\n    .update(users)\n    .set({\n      plan: newPlan,\n      stripeSubscriptionId: subscriptionId,\n      stripeSubscriptionStatus: typeof subscription.status === \"string\" ? subscription.status : null,\n      stripePriceId: typeof priceId === \"string\" ? priceId : null,\n      stripeCurrentPeriodEnd: currentPeriodEndDate,\n      stripeCancelAtPeriodEnd: cancelAtPeriodEnd,\n    })\n    .where(eq(users.id, user.id))\n    .returning();\n\n  const updated = updatedRows[0];\n  if (!updated) {\n    return Response.json({ error: \"Failed to update subscription\" }, { status: 500 });\n  }\n\n  return Response.json({ plan: updated.plan, stripeSubscriptionId: updated.stripeSubscriptionId });\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/webhooks/github/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/webhooks/stripe/route.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'POST' has a complexity of 32. Maximum allowed is 10.","line":70,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":215,"endColumn":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { eq } from \"drizzle-orm\";\n\nimport { db } from \"../../../../lib/db/client\";\nimport { users } from \"../../../../lib/db/schema\";\nimport { readRequiredEnv } from \"../../../../lib/env/read-required-env\";\nimport { getPlanForPriceId } from \"../../../../lib/stripe/constants\";\nimport { getStripe } from \"../../../../lib/stripe/client\";\n\ntype UserForStripeWebhook = {\n  id: string;\n  plan: string;\n  stripeCustomerId: string | null;\n  stripeLastWebhookEventId: string | null;\n  stripeLastWebhookEventCreated: bigint | null;\n};\n\nfunction toUnixSecondsBigint(value: unknown): bigint | null {\n  if (typeof value === \"number\" && Number.isFinite(value)) return BigInt(Math.floor(value));\n  if (typeof value === \"string\" && value.trim().length > 0) {\n    const parsed = Number(value);\n    return Number.isFinite(parsed) ? BigInt(Math.floor(parsed)) : null;\n  }\n  if (typeof value === \"bigint\") return value;\n  return null;\n}\n\nfunction toUnixSecondsDate(value: unknown): Date | null {\n  if (typeof value === \"number\" && Number.isFinite(value)) return new Date(Math.floor(value) * 1000);\n  if (typeof value === \"string\" && value.trim().length > 0) {\n    const parsed = Number(value);\n    return Number.isFinite(parsed) ? new Date(Math.floor(parsed) * 1000) : null;\n  }\n  if (typeof value === \"bigint\") {\n    const parsed = Number(value);\n    return Number.isSafeInteger(parsed) ? new Date(parsed * 1000) : null;\n  }\n  return null;\n}\n\nfunction getExpandedId(value: unknown): string | null {\n  if (typeof value === \"string\" && value.length > 0) return value;\n  if (value && typeof value === \"object\" && \"id\" in value && typeof (value as { id?: unknown }).id === \"string\") {\n    const id = (value as { id: string }).id;\n    return id.length > 0 ? id : null;\n  }\n  return null;\n}\n\nfunction shouldIgnoreEvent(user: UserForStripeWebhook, eventId: string, eventCreated: bigint | null): boolean {\n  if (user.stripeLastWebhookEventId && user.stripeLastWebhookEventId === eventId) return true;\n  if (eventCreated && user.stripeLastWebhookEventCreated && eventCreated < user.stripeLastWebhookEventCreated) return true;\n  return false;\n}\n\nasync function findUserByStripeCustomerId(customerId: string): Promise<UserForStripeWebhook | null> {\n  const rows = await db\n    .select({\n      id: users.id,\n      plan: users.plan,\n      stripeCustomerId: users.stripeCustomerId,\n      stripeLastWebhookEventId: users.stripeLastWebhookEventId,\n      stripeLastWebhookEventCreated: users.stripeLastWebhookEventCreated,\n    })\n    .from(users)\n    .where(eq(users.stripeCustomerId, customerId));\n\n  return rows[0] ?? null;\n}\n\nexport async function POST(request: Request): Promise<Response> {\n  const signatureHeader = request.headers.get(\"stripe-signature\");\n  if (!signatureHeader) {\n    return new Response(\"Missing Stripe signature\", { status: 400 });\n  }\n\n  const secret = readRequiredEnv(\"STRIPE_WEBHOOK_SECRET\");\n  const body = await request.text();\n\n  const stripe = getStripe();\n\n  let event: any;\n  try {\n    event = stripe.webhooks.constructEvent(body, signatureHeader, secret);\n  } catch (error) {\n    console.error(\"stripe.webhook.signature_verification_failed\", { error });\n    return new Response(\"Invalid Stripe signature\", { status: 400 });\n  }\n\n  const eventId = typeof event?.id === \"string\" ? event.id : \"unknown\";\n  const eventType = typeof event?.type === \"string\" ? event.type : \"unknown\";\n  const eventCreated = toUnixSecondsBigint(event?.created);\n\n  const object = event?.data?.object;\n\n  const customerId =\n    typeof object?.customer === \"string\"\n      ? object.customer\n      : typeof object?.customer?.id === \"string\"\n        ? object.customer.id\n        : null;\n\n  const subscriptionId =\n    typeof object?.subscription === \"string\"\n      ? object.subscription\n      : typeof object?.id === \"string\" && (object?.object === \"subscription\" || eventType.startsWith(\"customer.subscription.\"))\n        ? object.id\n        : null;\n\n  const priceId = object?.items?.data?.[0]?.price?.id;\n\n  if (!customerId) {\n    console.error(\"stripe.webhook.missing_customer\", { eventId, eventType, subscriptionId, priceId });\n    return Response.json({ ok: true }, { status: 200 });\n  }\n\n  const user = await findUserByStripeCustomerId(customerId);\n  if (!user) {\n    console.error(\"stripe.webhook.user_not_found\", { eventId, eventType, customerId, subscriptionId, priceId });\n    return Response.json({ ok: true }, { status: 200 });\n  }\n\n  if (shouldIgnoreEvent(user, eventId, eventCreated)) {\n    return Response.json({ ok: true, ignored: true }, { status: 200 });\n  }\n\n  try {\n    switch (eventType) {\n      case \"checkout.session.completed\": {\n        const checkoutSubscriptionId = getExpandedId(object?.subscription);\n        if (!checkoutSubscriptionId) {\n          console.info(\"stripe.webhook.checkout_session_completed.no_subscription\", { eventId, customerId });\n          break;\n        }\n\n        await db\n          .update(users)\n          .set({\n            stripeSubscriptionId: checkoutSubscriptionId,\n            stripeLastWebhookEventId: eventId,\n            stripeLastWebhookEventCreated: eventCreated,\n          })\n          .where(eq(users.id, user.id));\n\n        break;\n      }\n\n      case \"customer.subscription.updated\": {\n        const mappedPlan = typeof priceId === \"string\" ? getPlanForPriceId(priceId) : null;\n        if (!mappedPlan && typeof priceId === \"string\") {\n          console.error(\"stripe.webhook.unknown_price_id\", { eventId, eventType, customerId, subscriptionId, priceId, userId: user.id });\n        }\n\n        const cancelAtDate = toUnixSecondsDate(object?.cancel_at);\n        const currentPeriodEndDate = toUnixSecondsDate(object?.current_period_end) ?? cancelAtDate;\n        const hasScheduledCancellation = !!cancelAtDate && (object?.canceled_at === null || object?.canceled_at === undefined);\n        const cancelAtPeriodEnd =\n          hasScheduledCancellation || typeof object?.cancel_at_period_end !== \"boolean\" ? hasScheduledCancellation : object.cancel_at_period_end;\n\n        const setValues: Record<string, unknown> = {\n          stripeSubscriptionId: subscriptionId,\n          stripeSubscriptionStatus: typeof object?.status === \"string\" ? object.status : null,\n          stripePriceId: typeof priceId === \"string\" ? priceId : null,\n          stripeCurrentPeriodEnd: currentPeriodEndDate,\n          stripeCancelAtPeriodEnd: cancelAtPeriodEnd,\n          stripeLastWebhookEventId: eventId,\n          stripeLastWebhookEventCreated: eventCreated,\n        };\n\n        if (mappedPlan) {\n          setValues.plan = mappedPlan;\n        }\n\n        await db.update(users).set(setValues).where(eq(users.id, user.id));\n        break;\n      }\n\n      case \"customer.subscription.deleted\": {\n        const status = typeof object?.status === \"string\" ? object.status : null;\n        await db\n          .update(users)\n          .set({\n            plan: \"free\",\n            stripeSubscriptionStatus: status,\n            stripeLastWebhookEventId: eventId,\n            stripeLastWebhookEventCreated: eventCreated,\n          })\n          .where(eq(users.id, user.id));\n        break;\n      }\n\n      case \"invoice.payment_failed\": {\n        await db\n          .update(users)\n          .set({\n            stripeSubscriptionId: subscriptionId,\n            stripeSubscriptionStatus: \"past_due\",\n            stripeLastWebhookEventId: eventId,\n            stripeLastWebhookEventCreated: eventCreated,\n          })\n          .where(eq(users.id, user.id));\n        break;\n      }\n\n      default: {\n        console.info(\"stripe.webhook.unhandled_event\", { eventId, eventType, customerId, subscriptionId, priceId });\n        break;\n      }\n    }\n  } catch (error) {\n    console.error(\"stripe.webhook.processing_failed\", { eventId, eventType, customerId, subscriptionId, priceId, error });\n    return new Response(\"Webhook handler error\", { status: 500 });\n  }\n\n  return Response.json({ ok: true }, { status: 200 });\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/dashboard/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/login/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/live-event.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/mobile-tab-bar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/onboarding-checklist.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/page-views-chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/project-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/quota-display.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/sessions-chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/stat-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/status-badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/top-list.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/user-dropdown.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":68,"column":11,"nodeType":"JSXOpeningElement","endLine":68,"endColumn":93}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useRef, useState } from \"react\";\n\nexport type UserDropdownProps = {\n  username: string;\n  avatarUrl: string | null;\n};\n\nfunction getInitial(username: string): string {\n  const trimmed = username.trim();\n  const initial = trimmed[0] ?? \"?\";\n  return initial.toUpperCase();\n}\n\nexport default function UserDropdown({ username, avatarUrl }: UserDropdownProps) {\n  const [open, setOpen] = useState(false);\n  const rootRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    function onDocumentMouseDown(event: MouseEvent) {\n      if (!open) return;\n      const target = event.target as Node | null;\n      if (!target) return;\n      if (rootRef.current && !rootRef.current.contains(target)) {\n        setOpen(false);\n      }\n    }\n\n    function onDocumentTouchStart(event: TouchEvent) {\n      if (!open) return;\n      const target = event.target as Node | null;\n      if (!target) return;\n      if (rootRef.current && !rootRef.current.contains(target)) {\n        setOpen(false);\n      }\n    }\n\n    function onDocumentKeyDown(event: KeyboardEvent) {\n      if (!open) return;\n      if (event.key === \"Escape\") {\n        setOpen(false);\n      }\n    }\n\n    document.addEventListener(\"mousedown\", onDocumentMouseDown);\n    document.addEventListener(\"touchstart\", onDocumentTouchStart);\n    document.addEventListener(\"keydown\", onDocumentKeyDown);\n\n    return () => {\n      document.removeEventListener(\"mousedown\", onDocumentMouseDown);\n      document.removeEventListener(\"touchstart\", onDocumentTouchStart);\n      document.removeEventListener(\"keydown\", onDocumentKeyDown);\n    };\n  }, [open]);\n\n  return (\n    <div ref={rootRef} className=\"relative\">\n      <button\n        type=\"button\"\n        data-testid=\"user-dropdown-trigger\"\n        aria-haspopup=\"menu\"\n        aria-expanded={open}\n        onClick={() => setOpen((prev) => !prev)}\n        className=\"group flex items-center gap-2 rounded-lg border border-warm-200 bg-white px-2 py-1.5 text-sm font-medium text-warm-700 shadow-sm transition-all hover:border-warm-300 hover:bg-warm-50 hover:text-warm-900\"\n      >\n        {avatarUrl ? (\n          <img src={avatarUrl} alt={`${username} avatar`} className=\"size-8 rounded-full\" />\n        ) : (\n          <div className=\"flex size-8 items-center justify-center rounded-full bg-warm-200 text-sm font-semibold text-warm-700\">\n            {getInitial(username)}\n          </div>\n        )}\n        <span className=\"hidden max-w-40 truncate sm:inline\">{username}</span>\n        <svg\n          data-testid=\"user-dropdown-chevron\"\n          className={`size-4 text-warm-400 transition-transform group-hover:text-warm-600 ${open ? \"rotate-180\" : \"\"}`}\n          viewBox=\"0 0 16 16\"\n          fill=\"none\"\n          aria-hidden=\"true\"\n        >\n          <path d=\"M4 6l4 4 4-4\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n        </svg>\n      </button>\n\n      {open && (\n        <div\n          data-testid=\"user-dropdown-menu\"\n          role=\"menu\"\n          className=\"absolute right-0 z-20 mt-2 w-56 overflow-hidden rounded-xl border border-warm-200 bg-white shadow-warm-lg\"\n        >\n          <div className=\"border-b border-warm-100 px-4 py-3\">\n            <div className=\"text-xs font-medium text-warm-500\">Signed in as</div>\n            <div className=\"mt-1 truncate text-sm font-semibold text-warm-900\">{username}</div>\n          </div>\n          <form action=\"/api/auth/logout\" method=\"post\" className=\"p-2\">\n            <button\n              type=\"submit\"\n              className=\"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-warm-700 transition-colors hover:bg-warm-50 hover:text-warm-900\"\n            >\n              <svg className=\"size-4 text-warm-400\" viewBox=\"0 0 16 16\" fill=\"none\" aria-hidden=\"true\">\n                <path d=\"M6 14H3a1 1 0 01-1-1V3a1 1 0 011-1h3M11 11l3-3-3-3M14 8H6\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n              </svg>\n              Log out\n            </button>\n          </form>\n        </div>\n      )}\n    </div>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/features.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/hero.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":74,"column":15,"nodeType":"JSXOpeningElement","endLine":79,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\n\nexport type MarketingHeroProps = {\n  installUrl: string;\n  docsUrl: string;\n  dashboardImageSrc: string;\n};\n\nfunction isExternalUrl(url: string): boolean {\n  return url.startsWith(\"http://\") || url.startsWith(\"https://\");\n}\n\nexport default function MarketingHero({ installUrl, docsUrl, dashboardImageSrc }: MarketingHeroProps) {\n  const installIsExternal = isExternalUrl(installUrl);\n  const docsIsExternal = isExternalUrl(docsUrl);\n  return (\n    <section className=\"relative overflow-hidden px-6 pb-16 pt-20 md:px-10 md:pb-24 md:pt-32 lg:px-40\">\n      <div className=\"mx-auto flex max-w-[960px] flex-col items-center text-center\">\n        <div className=\"mb-6 inline-flex items-center gap-2 rounded-full border border-[#ec7f13]/20 bg-[#ec7f13]/10 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-[#9a734c]\">\n          <span className=\"size-2 animate-pulse rounded-full bg-[#ec7f13]\" />\n          V2.0 IS NOW LIVE\n        </div>\n\n        <h1 className=\"mb-6 max-w-3xl font-display text-4xl font-semibold leading-[1.1] tracking-tight text-[#1b140d] md:text-6xl\">\n          Analytics for Next.js, installed in one click.\n        </h1>\n\n        <p className=\"mb-10 max-w-2xl text-lg leading-relaxed text-[#9a734c] md:text-xl\">\n          Connect your GitHub repo. We send a PR. You get analytics.{\" \"}\n          <br className=\"hidden md:block\" />\n          No consent banner needed, no complex setup, just clean data.\n        </p>\n\n        <div className=\"flex w-full flex-col gap-4 sm:w-auto sm:flex-row\">\n          <a\n            className=\"flex h-12 items-center justify-center gap-2 rounded-lg bg-[#ec7f13] px-8 text-base font-medium text-white shadow-warm transition-all hover:scale-[0.98] hover:bg-orange-600 hover:shadow-warm-md active:scale-[0.96] active:shadow-none\"\n            href={installUrl}\n            rel={installIsExternal ? \"noreferrer\" : undefined}\n            target={installIsExternal ? \"_blank\" : undefined}\n          >\n            <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-5\">\n              <path\n                fill=\"currentColor\"\n                d=\"M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.166 6.839 9.489.5.092.682-.217.682-.482 0-.237-.009-.866-.013-1.7-2.782.603-3.369-1.342-3.369-1.342-.454-1.155-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.163 22 16.418 22 12c0-5.523-4.477-10-10-10z\"\n              />\n            </svg>\n            Sign in with GitHub\n          </a>\n          <a\n            className=\"flex h-12 items-center justify-center gap-2 rounded-lg border border-[#e8e0d9] bg-white px-8 text-base font-medium text-[#1b140d] shadow-sm transition-all hover:scale-[0.98] hover:bg-[#f3ede7] active:scale-[0.96] active:shadow-none\"\n            href={docsUrl}\n            rel={docsIsExternal ? \"noreferrer\" : undefined}\n            target={docsIsExternal ? \"_blank\" : undefined}\n          >\n            <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-5 text-[#9a734c]\">\n              <path\n                fill=\"currentColor\"\n                d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"\n              />\n            </svg>\n            Read the Docs\n          </a>\n        </div>\n\n        <div className=\"group relative mt-16 w-full md:mt-24\">\n          <div className=\"absolute -inset-1 rounded-lg bg-gradient-to-r from-[#ec7f13]/20 to-[#e8e0d9] blur opacity-25 transition duration-1000 group-hover:opacity-40 group-hover:duration-200\" />\n          <div className=\"relative overflow-hidden rounded-lg border border-[#e8e0d9] bg-white shadow-warm-lg\">\n            <div className=\"flex items-center gap-1.5 border-b border-[#e8e0d9] bg-white/50 px-4 py-3\">\n              <div className=\"size-3 rounded-full bg-[#ff5f57]\" />\n              <div className=\"size-3 rounded-full bg-[#febc2e]\" />\n              <div className=\"size-3 rounded-full bg-[#28c840]\" />\n            </div>\n            <div className=\"aspect-[16/9] w-full bg-stone-50\">\n              <img\n                alt=\"Dashboard interface showing analytics graphs and data tables\"\n                className=\"h-full w-full object-cover\"\n                loading=\"lazy\"\n                src={dashboardImageSrc}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/how-it-works.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":142,"column":17,"nodeType":"JSXOpeningElement","endLine":147,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\n\nexport type MarketingHowItWorksProps = {\n  dashboardImageSrc: string;\n};\n\ntype Step = {\n  number: string;\n  title: string;\n  description: string;\n  icon: React.ReactNode;\n};\n\nconst STEPS: Step[] = [\n  {\n    number: '1',\n    title: 'Connect Repository',\n    description: 'Log in with GitHub and select the Next.js repository you want to track.',\n    icon: (\n      <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-10 text-[#ec7f13]\">\n        <path\n          fill=\"currentColor\"\n          d=\"M12 2a5 5 0 0 1 5 5v2h1a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h1V7a5 5 0 0 1 5-5zm-3 7h6V7a3 3 0 0 0-6 0v2zm3 4a2 2 0 0 0-1 3.732V18h2v-1.268A2 2 0 0 0 12 13z\"\n        />\n      </svg>\n    ),\n  },\n  {\n    number: '2',\n    title: 'Merge the PR',\n    description: 'We automatically create a PR with the lightweight analytics hook. Merge it.',\n    icon: (\n      <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-10 text-[#ec7f13]\">\n        <path\n          fill=\"currentColor\"\n          d=\"M7 3a3 3 0 0 1 2.83 4H12a5 5 0 0 1 5 5v1.17A3 3 0 1 1 15 16v-4a3 3 0 0 0-3-3H9.83A3 3 0 1 1 7 3zm0 2a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm10 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2z\"\n        />\n      </svg>\n    ),\n  },\n  {\n    number: '3',\n    title: 'See Insights',\n    description: 'Data starts flowing immediately. View your dashboard for real-time insights.',\n    icon: (\n      <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-10 text-[#ec7f13]\">\n        <path\n          fill=\"currentColor\"\n          d=\"M4 19h16v2H2V3h2v16zm4-2H6V9h2v8zm4 0h-2V5h2v12zm4 0h-2v-6h2v6zm4 0h-2v-9h2v9z\"\n        />\n      </svg>\n    ),\n  },\n  {\n    number: '4',\n    title: 'Stay in Sync',\n    description:\n      'Add new pages or refactor your routes — we detect changes and keep your tracking up to date. No manual maintenance.',\n    icon: (\n      <svg\n        viewBox=\"0 0 24 24\"\n        aria-hidden=\"true\"\n        className=\"size-10 text-[#ec7f13]\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        strokeWidth=\"2\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      >\n        <path d=\"M21 12a9 9 0 0 0-15.5-6.4\" />\n        <path d=\"M3 8V3h5\" />\n        <path d=\"M3 12a9 9 0 0 0 15.5 6.4\" />\n        <path d=\"M21 16v5h-5\" />\n      </svg>\n    ),\n  },\n];\n\nexport default function MarketingHowItWorks({ dashboardImageSrc }: MarketingHowItWorksProps) {\n  return (\n    <section id=\"how-it-works\" className=\"bg-[#fcfaf8] py-24\">\n      <div className=\"mx-auto max-w-[1200px] px-6 md:px-10 lg:px-40\">\n        <div className=\"mb-16 flex flex-col gap-4 md:flex-row md:items-end md:justify-between\">\n          <div>\n            <h2 className=\"mb-2 font-display text-3xl font-semibold text-[#1b140d]\">\n              How it works\n            </h2>\n            <p className=\"text-[#9a734c]\">\n              From zero to data in less than 2 minutes.\n            </p>\n          </div>\n          <a\n            className=\"flex items-center gap-1 font-medium text-[#ec7f13] transition-colors hover:text-orange-600\"\n            href=\"/docs\"\n          >\n            View technical docs\n            <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-4\">\n              <path\n                fill=\"currentColor\"\n                d=\"M13 5l7 7-7 7-1.4-1.4 4.6-4.6H4v-2h12.2l-4.6-4.6L13 5z\"\n              />\n            </svg>\n          </a>\n        </div>\n\n        <div className=\"relative\">\n          <div className=\"absolute left-[10%] right-[10%] top-12 hidden h-0.5 border-t border-dashed border-[#e8e0d9] md:block\" />\n\n          <div className=\"relative z-10 grid grid-cols-1 gap-12 md:grid-cols-4\">\n            {STEPS.map((step) => (\n              <div key={step.number} className=\"flex flex-col items-center text-center\">\n                <div className=\"relative mb-6 flex size-24 items-center justify-center rounded-full border-4 border-[#f3ede7] bg-white text-[#9a734c] shadow-sm\">\n                  <span className=\"absolute -right-2 -top-2 flex size-8 items-center justify-center rounded-full bg-[#ec7f13] text-sm font-bold text-white shadow-sm\">\n                    {step.number}\n                  </span>\n                  {step.icon}\n                </div>\n                <h3 className=\"mb-2 font-display text-lg font-semibold text-[#1b140d]\">\n                  {step.title}\n                </h3>\n                <p className=\"max-w-[240px] text-sm text-[#9a734c]\">\n                  {step.description}\n                </p>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"mt-16 w-full\">\n          <div className=\"rounded-xl border border-[#e8e0d9] bg-white shadow-warm-lg\">\n            <div className=\"flex items-center justify-between border-b border-[#e8e0d9] bg-stone-50/50 px-4 py-3\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"size-3 rounded-full bg-[#ff5f57]\" />\n                <div className=\"size-3 rounded-full bg-[#febc2e]\" />\n                <div className=\"size-3 rounded-full bg-[#28c840]\" />\n              </div>\n              <div className=\"text-xs font-medium text-stone-400\">app.tally.so/dashboard</div>\n              <div className=\"w-4\" />\n            </div>\n            <div className=\"bg-stone-50/50 p-4 md:p-6\">\n              <div className=\"overflow-hidden rounded-lg border border-[#e8e0d9] bg-white\">\n                <img\n                  alt=\"Dashboard preview showing analytics graphs and tables\"\n                  className=\"h-auto w-full\"\n                  loading=\"lazy\"\n                  src={dashboardImageSrc}\n                />\n              </div>\n            </div>\n            <div className=\"flex justify-center border-t border-[#e8e0d9] bg-white p-3\">\n              <p className=\"flex items-center gap-2 text-sm font-semibold text-[#1b140d]\">\n                <svg\n                  viewBox=\"0 0 24 24\"\n                  aria-hidden=\"true\"\n                  className=\"size-[18px] text-[#9a734c]\"\n                >\n                  <path\n                    fill=\"currentColor\"\n                    d=\"M12 5c-7 0-10 7-10 7s3 7 10 7 10-7 10-7-3-7-10-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm0-2.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z\"\n                  />\n                </svg>\n                Real-time dashboard view\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/navbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/pricing-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/set-and-forget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/what-you-get.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/coverage/block-navigation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/coverage/prettify.js","messages":[],"suppressedMessages":[{"ruleId":"complexity","severity":2,"message":"Function 'X' has a complexity of 18. Maximum allowed is 10.","line":2,"column":3220,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":2,"endColumn":4215,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"complexity","severity":2,"message":"Function 'W' has a complexity of 23. Maximum allowed is 10.","line":2,"column":4215,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":2,"endColumn":5198,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"complexity","severity":2,"message":"Function has a complexity of 15. Maximum allowed is 10.","line":2,"column":6722,"nodeType":"FunctionExpression","messageId":"complex","endLine":2,"endColumn":7511,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"complexity","severity":2,"message":"Function 'i' has a complexity of 11. Maximum allowed is 10.","line":2,"column":7521,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":2,"endColumn":9272,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"complexity","severity":2,"message":"Function 'ae' has a complexity of 12. Maximum allowed is 10.","line":2,"column":9747,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":2,"endColumn":10260,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"complexity","severity":2,"message":"Function 'D' has a complexity of 15. Maximum allowed is 10.","line":2,"column":10970,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":2,"endColumn":11894,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"complexity","severity":2,"message":"Function 'U' has a complexity of 22. Maximum allowed is 10.","line":2,"column":14778,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":2,"endColumn":15487,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/coverage/sorter.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/drizzle.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/e2e/auth.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/e2e/dashboard.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/app-url.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/auth/cookies.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/auth/get-user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/auth/github-oauth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/auth/session.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/drizzle-env.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/queries/github-tokens.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/queries/projects.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/queries/regenerate-requests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/queries/users.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/env.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/env/read-required-env.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/analyze.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/app.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/detect-framework.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/detection.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/generate.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/handlers/installation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/handlers/pull-request.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Async function 'handlePullRequestWebhook' has a complexity of 11. Maximum allowed is 10.","line":7,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":26,"endColumn":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { updateProjectStatusForPullRequestClosed } from \"../../db/queries/projects\";\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return typeof value === \"object\" && value !== null;\n}\n\nexport async function handlePullRequestWebhook(payload: unknown): Promise<void> {\n  if (!isRecord(payload)) return;\n  const action = payload.action;\n  if (action !== \"closed\") return;\n\n  const pullRequest = payload.pull_request;\n  const repository = payload.repository;\n  if (!isRecord(pullRequest) || !isRecord(repository)) return;\n\n  const prNumber = pullRequest.number;\n  const merged = pullRequest.merged;\n  const repoId = repository.id;\n\n  if (typeof prNumber !== \"number\" || !Number.isInteger(prNumber)) return;\n  if (typeof merged !== \"boolean\") return;\n  if (typeof repoId !== \"number\" || !Number.isFinite(repoId)) return;\n\n  const status = merged ? \"active\" : \"pr_closed\";\n  await updateProjectStatusForPullRequestClosed({ repoId: BigInt(repoId), prNumber, status });\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/handlers/push.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/pr-generator.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/templates/app-router.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/templates/insert-analytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/templates/pages-router.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/templates/paths.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/webhook-verify.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/hooks/use-live-feed.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/hooks/use-project.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/hooks/use-projects.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/providers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/stripe/client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/stripe/constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/stripe/plans.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/tinybird/client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/next-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/next.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/playwright.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/scripts/link-github-users.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/analytics-live-feed-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/analytics-overview-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/analytics-sessions-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/app-url.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/dashboard-data-fetching.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":11,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":11,"endColumn":94}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it, vi } from \"vitest\";\n\nimport Providers from \"../lib/providers\";\nimport { fetchProject } from \"../lib/hooks/use-project\";\n\ndescribe(\"dashboard data fetching\", () => {\n  it(\"renders a React Query provider wrapper\", () => {\n    const html = renderToStaticMarkup(\n      React.createElement(Providers, { children: React.createElement(\"div\", null, \"Hello\") }),\n    );\n    expect(html).toContain(\"Hello\");\n  });\n\n  it(\"fetchProject calls /api/projects/:id and returns JSON\", async () => {\n    const fetchSpy = vi.spyOn(globalThis, \"fetch\").mockResolvedValue({\n      ok: true,\n      json: async () => ({ project: { id: \"proj_test\" } }),\n    } as unknown as Response);\n\n    try {\n      const result = await fetchProject(\"proj_test\");\n      expect(fetchSpy).toHaveBeenCalledWith(\"/api/projects/proj_test\", expect.any(Object));\n      expect(result).toEqual({ project: { id: \"proj_test\" } });\n    } finally {\n      fetchSpy.mockRestore();\n    }\n  });\n\n  it(\"fetchProject throws a helpful error on non-2xx responses\", async () => {\n    const fetchSpy = vi.spyOn(globalThis, \"fetch\").mockResolvedValue({\n      ok: false,\n      json: async () => ({ error: \"Unauthorized\" }),\n    } as unknown as Response);\n\n    try {\n      await expect(fetchProject(\"proj_test\")).rejects.toThrow(\"Unauthorized\");\n    } finally {\n      fetchSpy.mockRestore();\n    }\n  });\n});\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/dashboard-header.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/dashboard-page.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/dashboard-shell.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/design-system-tailwind.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/detect-framework.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/drizzle-env.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/e2e-login.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/env.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-app-scaffold.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-project-cache.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-tinybird-client.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-track-route-cors.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-track-route-project-validation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-track-route-v2-schema.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-track-route.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/get-user.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-analyze.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-app.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-callback-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-detection.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-generate-events-url.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-generate.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-insertion.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-oauth-callback.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-oauth-redirect.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-oauth.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-templates.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-tokens.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-webhook-installation-handler.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-webhook-pull-request-handler.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-webhook-push-handler.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-webhooks-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/link-github-users-script.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/live-event.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/live-feed-page.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":19,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":22,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":46,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":49,"endColumn":9}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it } from \"vitest\";\n\nimport LiveFeedPage from \"../app/(dashboard)/projects/[id]/live/page\";\nimport { LIVE_FEED_REFETCH_INTERVAL_MS } from \"../lib/hooks/use-live-feed\";\n\ndescribe(\"/projects/[id]/live page\", () => {\n  it(\"polls every 5 seconds\", () => {\n    expect(LIVE_FEED_REFETCH_INTERVAL_MS).toBe(5000);\n  });\n\n  it(\"renders an empty state when there are no events\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"live-feed\", \"proj_123\"], { events: [], hasMore: false });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(LiveFeedPage, { params: { id: \"proj_123\" } }),\n      }),\n    );\n\n    expect(html).toContain(\"Live Feed\");\n    expect(html).toContain(\"No events yet\");\n  });\n\n  it(\"renders recent events\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"live-feed\", \"proj_123\"], {\n      events: [\n        {\n          id: \"e1\",\n          eventType: \"page_view\",\n          path: \"/\",\n          referrer: null,\n          timestamp: \"2025-01-01T00:00:00.000Z\",\n          relativeTime: \"3 seconds ago\",\n        },\n      ],\n      hasMore: false,\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(LiveFeedPage, { params: { id: \"proj_123\" } }),\n      }),\n    );\n\n    expect(html).toContain(\"page_view\");\n    expect(html).toContain(\"/\");\n    expect(html).toContain(\"3 seconds ago\");\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/login-page-oauth.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/logout-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/logout-no-cookie.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-copy.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-docs-pages.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-footer-links.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-landing-page.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-legal-pages.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-pricing-page.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/middleware.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/migrations.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/overview-page.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":20,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":23,"endColumn":9}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it } from \"vitest\";\n\nimport OverviewPage from \"../app/(dashboard)/projects/[id]/overview/page\";\n\ndescribe(\"/projects/[id]/overview page\", () => {\n  it(\"renders summary stats and top lists from cached query data\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"overview\", \"proj_123\", \"7d\"], {\n      period: \"7d\",\n      pageViews: { total: 30, change: 100, timeSeries: [{ date: \"2025-01-01\", count: 30 }] },\n      sessions: { total: 5, change: -50 },\n      topPages: [{ path: \"/\", views: 20, percentage: 66.67 }],\n      topReferrers: [{ referrer: \"Direct\", count: 5, percentage: 100 }],\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(OverviewPage, { params: { id: \"proj_123\" } }),\n      }),\n    );\n\n    expect(html).toContain(\"Overview\");\n    expect(html).toContain(\"Page views\");\n    expect(html).toContain(\"30\");\n    expect(html).toContain(\"Sessions\");\n    expect(html).toContain(\"5\");\n    expect(html).toContain(\"Top pages\");\n    expect(html).toContain(\"Top referrers\");\n    expect(html).toContain(\"Direct\");\n  });\n});\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/pr-generator.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/project-detail-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/project-detail-page.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":32,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":35,"endColumn":9}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it } from \"vitest\";\n\nimport ProjectDetailPage from \"../app/(dashboard)/projects/[id]/page\";\n\ndescribe(\"/projects/[id] page\", () => {\n  it(\"renders the repo name, PR link, onboarding checklist, and regenerate button when eligible\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"analysis_failed\",\n        prNumber: 1,\n        prUrl: \"https://github.com/octo/repo/pull/1\",\n        detectedFramework: \"nextjs-app\",\n        detectedAnalytics: [],\n        eventsThisMonth: 0,\n        lastEventAt: null,\n        createdAt: \"2024-01-01T00:00:00.000Z\",\n        updatedAt: \"2024-01-01T00:00:00.000Z\",\n      },\n      quotaLimit: 10000,\n      quotaUsed: 0,\n      isOverQuota: false,\n      userPlan: \"free\",\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(ProjectDetailPage, { params: { id: \"proj_123\" } }),\n      }),\n    );\n\n    expect(html).toContain(\"octo/repo\");\n    expect(html).toContain('href=\"https://github.com/octo/repo/pull/1\"');\n    expect(html).toContain(\"Getting Started\");\n    expect(html).toContain(\"Re-run Analysis\"); // Button text changed from \"Regenerate PR\"\n    expect(html).toContain(\"Analysis Failed\"); // Status-specific card for failed state\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/project-layout.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":24,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":30,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":26,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":29,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":48,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":54,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":50,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":53,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":71,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":77,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":73,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":76,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":94,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":100,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":96,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":99,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":117,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":123,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":119,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":122,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":140,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":146,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":142,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":145,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":163,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":172,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":165,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":171,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":190,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":196,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":192,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":195,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":213,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":219,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":215,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":218,"endColumn":10}],"suppressedMessages":[],"errorCount":18,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it, vi } from \"vitest\";\n\nvi.mock(\"next/navigation\", () => ({\n  usePathname: () => \"/projects/proj_123\",\n}));\n\nimport ProjectLayout from \"../app/(dashboard)/projects/[id]/layout\";\n\ndescribe(\"project layout\", () => {\n  it(\"renders breadcrumb with Projects link\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_123\" }, children: React.createElement(\"div\", { \"data-testid\": \"child\" }, \"Child content\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain('href=\"/projects\"');\n    expect(html).toContain(\"Projects\");\n  });\n\n  it(\"renders project name from data\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_123\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"octo/repo\");\n  });\n\n  it(\"renders status badge when status is available\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_123\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"Active\");\n  });\n\n  it(\"renders tab navigation with correct links\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_123\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain('href=\"/projects/proj_123\"');\n    expect(html).toContain('href=\"/projects/proj_123/overview\"');\n    expect(html).toContain('href=\"/projects/proj_123/live\"');\n    expect(html).toContain('href=\"/projects/proj_123/sessions\"');\n    expect(html).toContain(\"Overview\");\n    expect(html).toContain(\"Analytics\");\n    expect(html).toContain(\"Live Feed\");\n    expect(html).toContain(\"Sessions\");\n  });\n\n  it(\"renders skeleton when data is pending\", () => {\n    const queryClient = new QueryClient();\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_456\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"animate-shimmer\");\n  });\n\n  it(\"renders project ID as fallback when repo name is not available\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_789\"], {\n      project: {\n        id: \"proj_789\",\n        githubRepoFullName: null,\n        status: \"pending\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_789\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"proj_789\");\n  });\n\n  it(\"renders children content\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          {\n            params: { id: \"proj_123\" },\n            children: React.createElement(\"div\", { className: \"test-child\" }, \"My child content\"),\n          },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"My child content\");\n    expect(html).toContain(\"test-child\");\n  });\n\n  it(\"highlights the active tab based on pathname\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_123\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"bg-slate-900\");\n  });\n\n  it(\"renders different statuses correctly\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_analyzing\"], {\n      project: {\n        id: \"proj_analyzing\",\n        githubRepoFullName: \"user/analyzing-repo\",\n        status: \"analyzing\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_analyzing\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"Analyzing\");\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/project-polling.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/projects-list-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/projects-list-page.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":19,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":22,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":47,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":50,"endColumn":9}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it } from \"vitest\";\n\nimport ProjectsPage from \"../app/(dashboard)/projects/page\";\nimport { PROJECT_LIST_REFETCH_INTERVAL_MS } from \"../lib/hooks/use-projects\";\n\ndescribe(\"/projects page\", () => {\n  it(\"configures polling every 10 seconds\", () => {\n    expect(PROJECT_LIST_REFETCH_INTERVAL_MS).toBe(10_000);\n  });\n\n  it(\"renders an empty state when there are no projects\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"projects\"], { projects: [] });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(ProjectsPage),\n      }),\n    );\n\n    expect(html).toContain(\"Projects\");\n    expect(html).toContain(\"No projects yet\");\n  });\n\n  it(\"renders project cards that link to the detail page\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"projects\"], {\n      projects: [\n        {\n          id: \"proj_123\",\n          githubRepoFullName: \"octo/repo\",\n          status: \"active\",\n          prUrl: null,\n          detectedFramework: \"nextjs-app\",\n          eventsThisMonth: 0,\n          lastEventAt: null,\n          createdAt: \"2024-01-01T00:00:00.000Z\",\n        },\n      ],\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(ProjectsPage),\n      }),\n    );\n\n    expect(html).toContain(\"octo/repo\");\n    expect(html).toContain('href=\"/projects/proj_123\"');\n    expect(html).toContain(\"Active\");\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/projects-queries.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/quota-display.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/regenerate-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/regenerate-requests-queries.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/root-layout-metadata.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/schema.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/session.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/sessions-page.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":23,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":26,"endColumn":9}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it } from \"vitest\";\n\nimport SessionsPage from \"../app/(dashboard)/projects/[id]/sessions/page\";\n\ndescribe(\"/projects/[id]/sessions page\", () => {\n  it(\"renders summary stats and chart from cached query data\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"sessions\", \"proj_123\", \"7d\"], {\n      period: \"7d\",\n      totalSessions: 5,\n      newVisitors: 5,\n      returningVisitors: 0,\n      timeSeries: [\n        { date: \"2025-01-01\", newSessions: 2, returningSessions: 0 },\n        { date: \"2025-01-02\", newSessions: 3, returningSessions: 0 },\n      ],\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(SessionsPage, { params: { id: \"proj_123\" } }),\n      }),\n    );\n\n    expect(html).toContain(\"Sessions\");\n    expect(html).toContain(\"Total sessions\");\n    expect(html).toContain(\"5\");\n    expect(html).toContain(\"New visitors\");\n    expect(html).toContain(\"Returning visitors\");\n  });\n});\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/settings-page.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-checkout-additional.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-checkout-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-client.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-env-example.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-migration.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-plans.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-portal-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-reconcile-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-webhook-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-webhook-handlers.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-client.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-daily-aggregates.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-events-datasource.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-live-feed.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-page-views-timeseries.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-sql-client.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-top-pages.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-top-referrers.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/user-dropdown.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/users-queries.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/types/database.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/types/github.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
