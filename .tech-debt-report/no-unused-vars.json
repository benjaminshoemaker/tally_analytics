[{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/[id]/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/[id]/live/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/[id]/overview/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/[id]/sessions/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/projects/page.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'FolderPlusIcon' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from \"react\";\n\nimport ProjectCard from \"../../../components/dashboard/project-card\";\nimport { SkeletonCard } from \"../../../components/dashboard/skeleton\";\nimport { useProjects } from \"../../../lib/hooks/use-projects\";\n\nfunction FolderPlusIcon() {\n  return (\n    <svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\" className=\"text-warm-300\">\n      <path\n        d=\"M44 38C44 39.0609 43.5786 40.0783 42.8284 40.8284C42.0783 41.5786 41.0609 42 40 42H8C6.93913 42 5.92172 41.5786 5.17157 40.8284C4.42143 40.0783 4 39.0609 4 38V10C4 8.93913 4.42143 7.92172 5.17157 7.17157C5.92172 6.42143 6.93913 6 8 6H18L22 12H40C41.0609 12 42.0783 12.4214 42.8284 13.1716C43.5786 13.9217 44 14.9391 44 16V38Z\"\n        stroke=\"currentColor\"\n        strokeWidth=\"2\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n      <path d=\"M24 22V34\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n      <path d=\"M18 28H30\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n    </svg>\n  );\n}\n\nexport default function ProjectsPage() {\n  const projectsQuery = useProjects();\n\n  return (\n    <div className=\"flex w-full flex-col gap-6\">\n      <header className=\"flex flex-col gap-2 opacity-0 animate-fade-in\">\n        <h1 className=\"font-display text-3xl tracking-tight text-warm-900\">Projects</h1>\n        <p className=\"text-sm text-warm-500\">Your connected repositories.</p>\n      </header>\n\n      {projectsQuery.isPending ? (\n        <div className=\"grid gap-4 md:grid-cols-2\">\n          {Array.from({ length: 4 }).map((_, i) => (\n            <SkeletonCard key={i} />\n          ))}\n        </div>\n      ) : projectsQuery.isError ? (\n        <div className=\"rounded-lg border border-red-200 bg-red-50 p-4 animate-fade-in\">\n          <p className=\"text-sm text-red-700\">Unable to load projects. Please try again.</p>\n        </div>\n      ) : projectsQuery.data.projects.length === 0 ? (\n        <div className=\"flex flex-col items-center justify-center rounded-xl border-2 border-dashed border-warm-300 bg-gradient-to-b from-warm-50 to-warm-100/50 px-8 py-16 text-center opacity-0 animate-fade-in-up\">\n          <div className=\"flex size-20 items-center justify-center rounded-2xl bg-brand-500/10 text-brand-500\">\n            <svg width=\"40\" height=\"40\" viewBox=\"0 0 48 48\" fill=\"none\">\n              <path\n                d=\"M44 38C44 39.0609 43.5786 40.0783 42.8284 40.8284C42.0783 41.5786 41.0609 42 40 42H8C6.93913 42 5.92172 41.5786 5.17157 40.8284C4.42143 40.0783 4 39.0609 4 38V10C4 8.93913 4.42143 7.92172 5.17157 7.17157C5.92172 6.42143 6.93913 6 8 6H18L22 12H40C41.0609 12 42.0783 12.4214 42.8284 13.1716C43.5786 13.9217 44 14.9391 44 16V38Z\"\n                stroke=\"currentColor\"\n                strokeWidth=\"2.5\"\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n              />\n              <path d=\"M24 22V34\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n              <path d=\"M18 28H30\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n            </svg>\n          </div>\n          <h3 className=\"mt-6 font-display text-xl text-warm-900\">No projects yet</h3>\n          <p className=\"mt-2 max-w-sm text-sm text-warm-500\">\n            Connect your first Next.js repository and we&apos;ll automatically set up analytics for you.\n          </p>\n          <a\n            href=\"https://github.com/apps/tally-analytics-agent\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            className=\"mt-6 inline-flex items-center gap-2 rounded-lg bg-brand-500 px-5 py-2.5 text-sm font-medium text-white shadow-warm transition-all hover:bg-brand-600 hover:shadow-warm-md\"\n          >\n            <svg className=\"size-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n              <path d=\"M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z\"/>\n            </svg>\n            Install GitHub App\n          </a>\n        </div>\n      ) : (\n        <div className=\"grid gap-4 md:grid-cols-2\">\n          {projectsQuery.data.projects.map((project, index) => (\n            <div key={project.id} className={`opacity-0 animate-fade-in stagger-${Math.min(index + 1, 6)}`}>\n              <ProjectCard project={project} />\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/settings/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(dashboard)/settings/stripe-reconcile-client.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/docs/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/docs/sdk/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/docs/setup/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/pricing/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/privacy/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/(marketing)/terms/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/auth/e2e-login/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/auth/github/callback/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/auth/github/route.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'_request' is defined but never used.","line":6,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":44}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from \"next/server\";\n\nimport { buildOAuthStateCookie } from \"../../../../lib/auth/cookies\";\nimport { buildGitHubAuthUrl, generateOAuthState } from \"../../../../lib/auth/github-oauth\";\n\nexport async function GET(_request: Request): Promise<Response> {\n  const state = generateOAuthState();\n  const url = buildGitHubAuthUrl(state);\n\n  const response = NextResponse.redirect(url, { status: 302 });\n  response.cookies.set(buildOAuthStateCookie(state));\n  return response;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/auth/logout/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/github/callback/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/[id]/analytics/live/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/[id]/analytics/overview/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/[id]/analytics/sessions/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/[id]/regenerate/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/[id]/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/projects/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/stripe/checkout/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/stripe/portal/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/stripe/reconcile/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/webhooks/github/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/api/webhooks/stripe/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/dashboard/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/app/login/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/live-event.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/mobile-tab-bar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/onboarding-checklist.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'CircleIcon' is defined but never used.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\n\ntype OnboardingProject = {\n  status: string;\n  prUrl: string | null;\n  lastEventAt: string | null;\n};\n\ntype Step = { id: string; label: string; description: string; done: boolean };\n\nfunction CheckIcon({ className }: { className?: string }) {\n  return (\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" className={className}>\n      <path\n        d=\"M13.333 4L5.999 11.333 2.666 8\"\n        stroke=\"currentColor\"\n        strokeWidth=\"2\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  );\n}\n\nfunction CircleIcon({ className }: { className?: string }) {\n  return (\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" className={className}>\n      <circle cx=\"8\" cy=\"8\" r=\"6\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\n    </svg>\n  );\n}\n\nfunction buildSteps(project: OnboardingProject): Step[] {\n  const prCreated = project.prUrl !== null;\n  const prMerged = project.status === \"active\";\n  const deployedAndSendingEvents = project.lastEventAt !== null;\n\n  return [\n    {\n      id: \"pr\",\n      label: \"Review the generated PR\",\n      description: \"Check the analytics integration code\",\n      done: prCreated,\n    },\n    {\n      id: \"merge\",\n      label: \"Merge the PR and deploy\",\n      description: \"Deploy to start collecting events\",\n      done: prMerged,\n    },\n    {\n      id: \"events\",\n      label: \"Confirm events are coming in\",\n      description: \"Visit your site to trigger events\",\n      done: deployedAndSendingEvents,\n    },\n  ];\n}\n\nexport default function OnboardingChecklist({ project }: { project: OnboardingProject }) {\n  const steps = buildSteps(project);\n  const completedCount = steps.filter((s) => s.done).length;\n  const progressPercent = Math.round((completedCount / steps.length) * 100);\n\n  return (\n    <section className=\"rounded-lg border border-warm-200 bg-white p-4 shadow-warm\">\n      <div className=\"flex items-center justify-between gap-3\">\n        <h2 className=\"font-display text-sm font-semibold text-warm-900\">Getting Started</h2>\n        <span className=\"text-xs font-medium text-warm-500\">\n          {completedCount}/{steps.length} complete\n        </span>\n      </div>\n\n      {/* Progress Bar */}\n      <div className=\"mt-3 h-1.5 w-full overflow-hidden rounded-full bg-warm-100\">\n        <div\n          className=\"h-full rounded-full bg-gradient-to-r from-brand-500 to-brand-400 transition-all duration-500\"\n          style={{ width: `${progressPercent}%` }}\n        />\n      </div>\n\n      <ul className=\"mt-4 flex flex-col gap-3\">\n        {steps.map((step, index) => {\n          const isNextStep = !step.done && steps.slice(0, index).every((s) => s.done);\n\n          return (\n            <li key={step.id} className=\"flex items-start gap-3\">\n              {/* Checkbox */}\n              <div\n                className={[\n                  \"mt-0.5 flex h-5 w-5 flex-shrink-0 items-center justify-center rounded-full transition-all duration-300\",\n                  step.done\n                    ? \"bg-emerald-500 text-white\"\n                    : isNextStep\n                      ? \"border-2 border-brand-300 text-brand-300\"\n                      : \"border border-warm-200 text-warm-200\",\n                ].join(\" \")}\n              >\n                {step.done ? <CheckIcon className=\"h-3 w-3\" /> : <span className=\"h-2 w-2\" />}\n              </div>\n\n              {/* Content */}\n              <div className=\"flex-1 min-w-0\">\n                <p\n                  className={[\n                    \"text-sm font-medium transition-colors\",\n                    step.done ? \"text-warm-400 line-through\" : \"text-warm-900\",\n                  ].join(\" \")}\n                >\n                  {step.label}\n                </p>\n                <p className=\"text-xs text-warm-500\">{step.description}</p>\n              </div>\n\n              {/* Status */}\n              {step.done && (\n                <span className=\"flex-shrink-0 rounded-full bg-emerald-50 px-2 py-0.5 text-xs font-medium text-emerald-700\">\n                  Done\n                </span>\n              )}\n              {isNextStep && (\n                <span className=\"flex-shrink-0 rounded-full bg-brand-50 px-2 py-0.5 text-xs font-medium text-brand-600\">\n                  Next\n                </span>\n              )}\n            </li>\n          );\n        })}\n      </ul>\n    </section>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/page-views-chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/project-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/quota-display.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/sessions-chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/stat-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/status-badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/top-list.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/dashboard/user-dropdown.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":68,"column":11,"nodeType":"JSXOpeningElement","endLine":68,"endColumn":93}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useRef, useState } from \"react\";\n\nexport type UserDropdownProps = {\n  username: string;\n  avatarUrl: string | null;\n};\n\nfunction getInitial(username: string): string {\n  const trimmed = username.trim();\n  const initial = trimmed[0] ?? \"?\";\n  return initial.toUpperCase();\n}\n\nexport default function UserDropdown({ username, avatarUrl }: UserDropdownProps) {\n  const [open, setOpen] = useState(false);\n  const rootRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    function onDocumentMouseDown(event: MouseEvent) {\n      if (!open) return;\n      const target = event.target as Node | null;\n      if (!target) return;\n      if (rootRef.current && !rootRef.current.contains(target)) {\n        setOpen(false);\n      }\n    }\n\n    function onDocumentTouchStart(event: TouchEvent) {\n      if (!open) return;\n      const target = event.target as Node | null;\n      if (!target) return;\n      if (rootRef.current && !rootRef.current.contains(target)) {\n        setOpen(false);\n      }\n    }\n\n    function onDocumentKeyDown(event: KeyboardEvent) {\n      if (!open) return;\n      if (event.key === \"Escape\") {\n        setOpen(false);\n      }\n    }\n\n    document.addEventListener(\"mousedown\", onDocumentMouseDown);\n    document.addEventListener(\"touchstart\", onDocumentTouchStart);\n    document.addEventListener(\"keydown\", onDocumentKeyDown);\n\n    return () => {\n      document.removeEventListener(\"mousedown\", onDocumentMouseDown);\n      document.removeEventListener(\"touchstart\", onDocumentTouchStart);\n      document.removeEventListener(\"keydown\", onDocumentKeyDown);\n    };\n  }, [open]);\n\n  return (\n    <div ref={rootRef} className=\"relative\">\n      <button\n        type=\"button\"\n        data-testid=\"user-dropdown-trigger\"\n        aria-haspopup=\"menu\"\n        aria-expanded={open}\n        onClick={() => setOpen((prev) => !prev)}\n        className=\"group flex items-center gap-2 rounded-lg border border-warm-200 bg-white px-2 py-1.5 text-sm font-medium text-warm-700 shadow-sm transition-all hover:border-warm-300 hover:bg-warm-50 hover:text-warm-900\"\n      >\n        {avatarUrl ? (\n          <img src={avatarUrl} alt={`${username} avatar`} className=\"size-8 rounded-full\" />\n        ) : (\n          <div className=\"flex size-8 items-center justify-center rounded-full bg-warm-200 text-sm font-semibold text-warm-700\">\n            {getInitial(username)}\n          </div>\n        )}\n        <span className=\"hidden max-w-40 truncate sm:inline\">{username}</span>\n        <svg\n          data-testid=\"user-dropdown-chevron\"\n          className={`size-4 text-warm-400 transition-transform group-hover:text-warm-600 ${open ? \"rotate-180\" : \"\"}`}\n          viewBox=\"0 0 16 16\"\n          fill=\"none\"\n          aria-hidden=\"true\"\n        >\n          <path d=\"M4 6l4 4 4-4\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n        </svg>\n      </button>\n\n      {open && (\n        <div\n          data-testid=\"user-dropdown-menu\"\n          role=\"menu\"\n          className=\"absolute right-0 z-20 mt-2 w-56 overflow-hidden rounded-xl border border-warm-200 bg-white shadow-warm-lg\"\n        >\n          <div className=\"border-b border-warm-100 px-4 py-3\">\n            <div className=\"text-xs font-medium text-warm-500\">Signed in as</div>\n            <div className=\"mt-1 truncate text-sm font-semibold text-warm-900\">{username}</div>\n          </div>\n          <form action=\"/api/auth/logout\" method=\"post\" className=\"p-2\">\n            <button\n              type=\"submit\"\n              className=\"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium text-warm-700 transition-colors hover:bg-warm-50 hover:text-warm-900\"\n            >\n              <svg className=\"size-4 text-warm-400\" viewBox=\"0 0 16 16\" fill=\"none\" aria-hidden=\"true\">\n                <path d=\"M6 14H3a1 1 0 01-1-1V3a1 1 0 011-1h3M11 11l3-3-3-3M14 8H6\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n              </svg>\n              Log out\n            </button>\n          </form>\n        </div>\n      )}\n    </div>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/features.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/hero.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":74,"column":15,"nodeType":"JSXOpeningElement","endLine":79,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\n\nexport type MarketingHeroProps = {\n  installUrl: string;\n  docsUrl: string;\n  dashboardImageSrc: string;\n};\n\nfunction isExternalUrl(url: string): boolean {\n  return url.startsWith(\"http://\") || url.startsWith(\"https://\");\n}\n\nexport default function MarketingHero({ installUrl, docsUrl, dashboardImageSrc }: MarketingHeroProps) {\n  const installIsExternal = isExternalUrl(installUrl);\n  const docsIsExternal = isExternalUrl(docsUrl);\n  return (\n    <section className=\"relative overflow-hidden px-6 pb-16 pt-20 md:px-10 md:pb-24 md:pt-32 lg:px-40\">\n      <div className=\"mx-auto flex max-w-[960px] flex-col items-center text-center\">\n        <div className=\"mb-6 inline-flex items-center gap-2 rounded-full border border-[#ec7f13]/20 bg-[#ec7f13]/10 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-[#9a734c]\">\n          <span className=\"size-2 animate-pulse rounded-full bg-[#ec7f13]\" />\n          V2.0 IS NOW LIVE\n        </div>\n\n        <h1 className=\"mb-6 max-w-3xl font-display text-4xl font-semibold leading-[1.1] tracking-tight text-[#1b140d] md:text-6xl\">\n          Analytics for Next.js, installed in one click.\n        </h1>\n\n        <p className=\"mb-10 max-w-2xl text-lg leading-relaxed text-[#9a734c] md:text-xl\">\n          Connect your GitHub repo. We send a PR. You get analytics.{\" \"}\n          <br className=\"hidden md:block\" />\n          No consent banner needed, no complex setup, just clean data.\n        </p>\n\n        <div className=\"flex w-full flex-col gap-4 sm:w-auto sm:flex-row\">\n          <a\n            className=\"flex h-12 items-center justify-center gap-2 rounded-lg bg-[#ec7f13] px-8 text-base font-medium text-white shadow-warm transition-all hover:scale-[0.98] hover:bg-orange-600 hover:shadow-warm-md active:scale-[0.96] active:shadow-none\"\n            href={installUrl}\n            rel={installIsExternal ? \"noreferrer\" : undefined}\n            target={installIsExternal ? \"_blank\" : undefined}\n          >\n            <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-5\">\n              <path\n                fill=\"currentColor\"\n                d=\"M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.166 6.839 9.489.5.092.682-.217.682-.482 0-.237-.009-.866-.013-1.7-2.782.603-3.369-1.342-3.369-1.342-.454-1.155-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.163 22 16.418 22 12c0-5.523-4.477-10-10-10z\"\n              />\n            </svg>\n            Sign in with GitHub\n          </a>\n          <a\n            className=\"flex h-12 items-center justify-center gap-2 rounded-lg border border-[#e8e0d9] bg-white px-8 text-base font-medium text-[#1b140d] shadow-sm transition-all hover:scale-[0.98] hover:bg-[#f3ede7] active:scale-[0.96] active:shadow-none\"\n            href={docsUrl}\n            rel={docsIsExternal ? \"noreferrer\" : undefined}\n            target={docsIsExternal ? \"_blank\" : undefined}\n          >\n            <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-5 text-[#9a734c]\">\n              <path\n                fill=\"currentColor\"\n                d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"\n              />\n            </svg>\n            Read the Docs\n          </a>\n        </div>\n\n        <div className=\"group relative mt-16 w-full md:mt-24\">\n          <div className=\"absolute -inset-1 rounded-lg bg-gradient-to-r from-[#ec7f13]/20 to-[#e8e0d9] blur opacity-25 transition duration-1000 group-hover:opacity-40 group-hover:duration-200\" />\n          <div className=\"relative overflow-hidden rounded-lg border border-[#e8e0d9] bg-white shadow-warm-lg\">\n            <div className=\"flex items-center gap-1.5 border-b border-[#e8e0d9] bg-white/50 px-4 py-3\">\n              <div className=\"size-3 rounded-full bg-[#ff5f57]\" />\n              <div className=\"size-3 rounded-full bg-[#febc2e]\" />\n              <div className=\"size-3 rounded-full bg-[#28c840]\" />\n            </div>\n            <div className=\"aspect-[16/9] w-full bg-stone-50\">\n              <img\n                alt=\"Dashboard interface showing analytics graphs and data tables\"\n                className=\"h-full w-full object-cover\"\n                loading=\"lazy\"\n                src={dashboardImageSrc}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/how-it-works.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":142,"column":17,"nodeType":"JSXOpeningElement","endLine":147,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\n\nexport type MarketingHowItWorksProps = {\n  dashboardImageSrc: string;\n};\n\ntype Step = {\n  number: string;\n  title: string;\n  description: string;\n  icon: React.ReactNode;\n};\n\nconst STEPS: Step[] = [\n  {\n    number: '1',\n    title: 'Connect Repository',\n    description: 'Log in with GitHub and select the Next.js repository you want to track.',\n    icon: (\n      <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-10 text-[#ec7f13]\">\n        <path\n          fill=\"currentColor\"\n          d=\"M12 2a5 5 0 0 1 5 5v2h1a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h1V7a5 5 0 0 1 5-5zm-3 7h6V7a3 3 0 0 0-6 0v2zm3 4a2 2 0 0 0-1 3.732V18h2v-1.268A2 2 0 0 0 12 13z\"\n        />\n      </svg>\n    ),\n  },\n  {\n    number: '2',\n    title: 'Merge the PR',\n    description: 'We automatically create a PR with the lightweight analytics hook. Merge it.',\n    icon: (\n      <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-10 text-[#ec7f13]\">\n        <path\n          fill=\"currentColor\"\n          d=\"M7 3a3 3 0 0 1 2.83 4H12a5 5 0 0 1 5 5v1.17A3 3 0 1 1 15 16v-4a3 3 0 0 0-3-3H9.83A3 3 0 1 1 7 3zm0 2a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm10 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2z\"\n        />\n      </svg>\n    ),\n  },\n  {\n    number: '3',\n    title: 'See Insights',\n    description: 'Data starts flowing immediately. View your dashboard for real-time insights.',\n    icon: (\n      <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-10 text-[#ec7f13]\">\n        <path\n          fill=\"currentColor\"\n          d=\"M4 19h16v2H2V3h2v16zm4-2H6V9h2v8zm4 0h-2V5h2v12zm4 0h-2v-6h2v6zm4 0h-2v-9h2v9z\"\n        />\n      </svg>\n    ),\n  },\n  {\n    number: '4',\n    title: 'Stay in Sync',\n    description:\n      'Add new pages or refactor your routes â€” we detect changes and keep your tracking up to date. No manual maintenance.',\n    icon: (\n      <svg\n        viewBox=\"0 0 24 24\"\n        aria-hidden=\"true\"\n        className=\"size-10 text-[#ec7f13]\"\n        fill=\"none\"\n        stroke=\"currentColor\"\n        strokeWidth=\"2\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      >\n        <path d=\"M21 12a9 9 0 0 0-15.5-6.4\" />\n        <path d=\"M3 8V3h5\" />\n        <path d=\"M3 12a9 9 0 0 0 15.5 6.4\" />\n        <path d=\"M21 16v5h-5\" />\n      </svg>\n    ),\n  },\n];\n\nexport default function MarketingHowItWorks({ dashboardImageSrc }: MarketingHowItWorksProps) {\n  return (\n    <section id=\"how-it-works\" className=\"bg-[#fcfaf8] py-24\">\n      <div className=\"mx-auto max-w-[1200px] px-6 md:px-10 lg:px-40\">\n        <div className=\"mb-16 flex flex-col gap-4 md:flex-row md:items-end md:justify-between\">\n          <div>\n            <h2 className=\"mb-2 font-display text-3xl font-semibold text-[#1b140d]\">\n              How it works\n            </h2>\n            <p className=\"text-[#9a734c]\">\n              From zero to data in less than 2 minutes.\n            </p>\n          </div>\n          <a\n            className=\"flex items-center gap-1 font-medium text-[#ec7f13] transition-colors hover:text-orange-600\"\n            href=\"/docs\"\n          >\n            View technical docs\n            <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\" className=\"size-4\">\n              <path\n                fill=\"currentColor\"\n                d=\"M13 5l7 7-7 7-1.4-1.4 4.6-4.6H4v-2h12.2l-4.6-4.6L13 5z\"\n              />\n            </svg>\n          </a>\n        </div>\n\n        <div className=\"relative\">\n          <div className=\"absolute left-[10%] right-[10%] top-12 hidden h-0.5 border-t border-dashed border-[#e8e0d9] md:block\" />\n\n          <div className=\"relative z-10 grid grid-cols-1 gap-12 md:grid-cols-4\">\n            {STEPS.map((step) => (\n              <div key={step.number} className=\"flex flex-col items-center text-center\">\n                <div className=\"relative mb-6 flex size-24 items-center justify-center rounded-full border-4 border-[#f3ede7] bg-white text-[#9a734c] shadow-sm\">\n                  <span className=\"absolute -right-2 -top-2 flex size-8 items-center justify-center rounded-full bg-[#ec7f13] text-sm font-bold text-white shadow-sm\">\n                    {step.number}\n                  </span>\n                  {step.icon}\n                </div>\n                <h3 className=\"mb-2 font-display text-lg font-semibold text-[#1b140d]\">\n                  {step.title}\n                </h3>\n                <p className=\"max-w-[240px] text-sm text-[#9a734c]\">\n                  {step.description}\n                </p>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"mt-16 w-full\">\n          <div className=\"rounded-xl border border-[#e8e0d9] bg-white shadow-warm-lg\">\n            <div className=\"flex items-center justify-between border-b border-[#e8e0d9] bg-stone-50/50 px-4 py-3\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"size-3 rounded-full bg-[#ff5f57]\" />\n                <div className=\"size-3 rounded-full bg-[#febc2e]\" />\n                <div className=\"size-3 rounded-full bg-[#28c840]\" />\n              </div>\n              <div className=\"text-xs font-medium text-stone-400\">app.tally.so/dashboard</div>\n              <div className=\"w-4\" />\n            </div>\n            <div className=\"bg-stone-50/50 p-4 md:p-6\">\n              <div className=\"overflow-hidden rounded-lg border border-[#e8e0d9] bg-white\">\n                <img\n                  alt=\"Dashboard preview showing analytics graphs and tables\"\n                  className=\"h-auto w-full\"\n                  loading=\"lazy\"\n                  src={dashboardImageSrc}\n                />\n              </div>\n            </div>\n            <div className=\"flex justify-center border-t border-[#e8e0d9] bg-white p-3\">\n              <p className=\"flex items-center gap-2 text-sm font-semibold text-[#1b140d]\">\n                <svg\n                  viewBox=\"0 0 24 24\"\n                  aria-hidden=\"true\"\n                  className=\"size-[18px] text-[#9a734c]\"\n                >\n                  <path\n                    fill=\"currentColor\"\n                    d=\"M12 5c-7 0-10 7-10 7s3 7 10 7 10-7 10-7-3-7-10-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm0-2.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z\"\n                  />\n                </svg>\n                Real-time dashboard view\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/navbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/pricing-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/set-and-forget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/components/marketing/what-you-get.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/coverage/block-navigation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/coverage/prettify.js","messages":[],"suppressedMessages":[{"ruleId":"no-unused-vars","severity":2,"message":"'ae' is assigned a value but never used.","line":2,"column":11414,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":11416,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-unused-vars","severity":2,"message":"'af' is assigned a value but never used.","line":2,"column":11438,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":11440,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-unused-vars","severity":2,"message":"'ag' is assigned a value but never used.","line":2,"column":11471,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":11473,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-unused-vars","severity":2,"message":"'ae' is assigned a value but never used.","line":2,"column":14757,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":14759,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/coverage/sorter.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/drizzle.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/e2e/auth.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/e2e/dashboard.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/app-url.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/auth/cookies.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/auth/get-user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/auth/github-oauth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/auth/session.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/drizzle-env.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/queries/github-tokens.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'installationId' is defined but never used.","line":78,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":71}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { and, eq } from \"drizzle-orm\";\n\nimport { getInstallationAccessToken, type GitHubInstallationAccessToken } from \"../../github/app\";\nimport { db } from \"../client\";\nimport { githubTokens } from \"../schema\";\n\nexport type UpsertInstallationTokenParams = {\n  userId: string;\n  installationId: bigint;\n  token: string;\n  expiresAt: Date;\n};\n\nexport async function upsertInstallationLink(params: { userId: string; installationId: bigint }): Promise<void> {\n  await db\n    .insert(githubTokens)\n    .values({ userId: params.userId, installationId: params.installationId })\n    .onConflictDoUpdate({\n      target: githubTokens.installationId,\n      set: { userId: params.userId },\n    });\n}\n\nexport async function upsertInstallationToken(params: UpsertInstallationTokenParams): Promise<void> {\n  await db\n    .insert(githubTokens)\n    .values({\n      userId: params.userId,\n      installationId: params.installationId,\n      installationAccessToken: params.token,\n      installationTokenExpiresAt: params.expiresAt,\n    })\n    .onConflictDoUpdate({\n      target: githubTokens.installationId,\n      set: {\n        userId: params.userId,\n        installationAccessToken: params.token,\n        installationTokenExpiresAt: params.expiresAt,\n      },\n    });\n}\n\nexport type StoredInstallationToken = {\n  token: string;\n  expiresAt: Date;\n};\n\nexport async function getStoredInstallationToken(params: {\n  userId: string;\n  installationId: bigint;\n  now?: Date;\n}): Promise<StoredInstallationToken | null> {\n  const now = params.now ?? new Date();\n\n  const rows = await db\n    .select({\n      token: githubTokens.installationAccessToken,\n      expiresAt: githubTokens.installationTokenExpiresAt,\n    })\n    .from(githubTokens)\n    .where(and(eq(githubTokens.userId, params.userId), eq(githubTokens.installationId, params.installationId)));\n\n  const row = rows[0];\n  if (!row?.token || !row.expiresAt) return null;\n  if (row.expiresAt.getTime() <= now.getTime()) return null;\n\n  return { token: row.token, expiresAt: row.expiresAt };\n}\n\nfunction toSafeNumber(value: bigint): number {\n  const asNumber = Number(value);\n  if (!Number.isSafeInteger(asNumber)) {\n    throw new Error(`Installation ID is too large to safely convert to number: ${value.toString()}`);\n  }\n  return asNumber;\n}\n\nexport type RefreshInstallationAccessTokenFn = (installationId: number) => Promise<GitHubInstallationAccessToken>;\n\nexport async function getOrRefreshInstallationToken(params: {\n  userId: string;\n  installationId: bigint;\n  now?: Date;\n  refreshInstallationAccessToken?: RefreshInstallationAccessTokenFn;\n}): Promise<StoredInstallationToken> {\n  const now = params.now ?? new Date();\n  const existing = await getStoredInstallationToken({ userId: params.userId, installationId: params.installationId, now });\n  if (existing) return existing;\n\n  const refresh = params.refreshInstallationAccessToken ?? getInstallationAccessToken;\n  const installationId = toSafeNumber(params.installationId);\n  const refreshed = await refresh(installationId);\n\n  const expiresAt = new Date(refreshed.expiresAt);\n  if (Number.isNaN(expiresAt.getTime())) {\n    throw new Error(`Invalid refreshed installation token expiry: ${JSON.stringify(refreshed.expiresAt)}`);\n  }\n\n  await upsertInstallationToken({\n    userId: params.userId,\n    installationId: params.installationId,\n    token: refreshed.token,\n    expiresAt,\n  });\n\n  return { token: refreshed.token, expiresAt };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/queries/projects.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/queries/regenerate-requests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/queries/users.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/db/schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/env.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/env/read-required-env.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/analyze.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/app.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'auth' is defined but never used.","line":18,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":45},{"ruleId":"no-unused-vars","severity":2,"message":"'options' is defined but never used.","line":25,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":77},{"ruleId":"no-unused-vars","severity":2,"message":"'installationId' is defined but never used.","line":29,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":54},{"ruleId":"no-unused-vars","severity":2,"message":"'installationId' is defined but never used.","line":30,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":50}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { App } from \"@octokit/app\";\nimport { Octokit } from \"@octokit/rest\";\n\nexport type GitHubAuth =\n  | { type: \"app\" }\n  | {\n      type: \"installation\";\n      installationId: number;\n    };\n\nexport type GitHubAuthResponse =\n  | { token: string }\n  | {\n      token: string;\n      expiresAt: string;\n    };\n\nexport type GitHubAuthFn = (auth: GitHubAuth) => Promise<GitHubAuthResponse>;\n\nexport type GitHubInstallationAccessToken = {\n  token: string;\n  expiresAt: string;\n};\n\nexport type CreateOctokitFn<TOctokit = Octokit> = (options: { auth: string }) => TOctokit;\n\nexport type GitHubAppClient<TOctokit = Octokit> = {\n  getAppJwt: () => Promise<string>;\n  getInstallationAccessToken: (installationId: number) => Promise<GitHubInstallationAccessToken>;\n  getInstallationOctokit: (installationId: number) => Promise<TOctokit>;\n};\n\nconst INSTALLATION_TOKEN_REFRESH_SKEW_MS = 60_000;\n\nfunction readRequiredEnv(name: string): string {\n  const value = process.env[name];\n  if (typeof value === \"string\" && value.length > 0) return value;\n\n  throw new Error(\n    `Missing required environment variable: ${name}. Set it in apps/web/.env.local for local dev, or in your Vercel project environment variables.`,\n  );\n}\n\nfunction readGitHubAppConfigFromEnv(): { appId: number; privateKey: string } {\n  const appIdRaw = readRequiredEnv(\"GITHUB_APP_ID\");\n  const appId = Number(appIdRaw);\n  if (!Number.isFinite(appId) || appId <= 0) {\n    throw new Error(`Invalid GITHUB_APP_ID: expected a positive number, got ${JSON.stringify(appIdRaw)}`);\n  }\n\n  const privateKey = readRequiredEnv(\"GITHUB_APP_PRIVATE_KEY\").replaceAll(\"\\\\n\", \"\\n\");\n  return { appId, privateKey };\n}\n\nfunction createDefaultAuth(appId: number, privateKey: string): GitHubAuthFn {\n  const app = new App({ appId, privateKey, Octokit });\n  return (auth) => app.octokit.auth(auth as never) as Promise<GitHubAuthResponse>;\n}\n\nexport function createGitHubAppClient<TOctokit = Octokit>(options: {\n  appId: number;\n  privateKey: string;\n  auth?: GitHubAuthFn;\n  now?: () => number;\n  createOctokit?: CreateOctokitFn<TOctokit>;\n}): GitHubAppClient<TOctokit> {\n  const auth = options.auth ?? createDefaultAuth(options.appId, options.privateKey);\n  const now = options.now ?? (() => Date.now());\n  const createOctokit: CreateOctokitFn<TOctokit> = options.createOctokit ?? ((o) => new Octokit(o) as never);\n\n  const installationTokenCache = new Map<number, GitHubInstallationAccessToken & { expiresAtMs: number }>();\n\n  async function getAppJwt(): Promise<string> {\n    const result = await auth({ type: \"app\" });\n    return result.token;\n  }\n\n  async function getInstallationAccessToken(installationId: number): Promise<GitHubInstallationAccessToken> {\n    const cached = installationTokenCache.get(installationId);\n    if (cached && cached.expiresAtMs - now() >= INSTALLATION_TOKEN_REFRESH_SKEW_MS) {\n      return { token: cached.token, expiresAt: cached.expiresAt };\n    }\n\n    const result = await auth({ type: \"installation\", installationId });\n    if (!(\"expiresAt\" in result)) {\n      throw new Error(\"Invalid GitHub installation auth response: missing expiresAt\");\n    }\n\n    const expiresAtMs = Date.parse(result.expiresAt);\n    if (!Number.isFinite(expiresAtMs)) {\n      throw new Error(`Invalid GitHub installation auth response: invalid expiresAt ${JSON.stringify(result.expiresAt)}`);\n    }\n\n    const token = { token: result.token, expiresAt: result.expiresAt, expiresAtMs };\n    installationTokenCache.set(installationId, token);\n    return { token: token.token, expiresAt: token.expiresAt };\n  }\n\n  async function getInstallationOctokit(installationId: number): Promise<TOctokit> {\n    const { token } = await getInstallationAccessToken(installationId);\n    return createOctokit({ auth: token });\n  }\n\n  return { getAppJwt, getInstallationAccessToken, getInstallationOctokit };\n}\n\nlet singleton: GitHubAppClient | null = null;\n\nfunction getSingleton(): GitHubAppClient {\n  if (singleton) return singleton;\n  const { appId, privateKey } = readGitHubAppConfigFromEnv();\n  singleton = createGitHubAppClient({ appId, privateKey });\n  return singleton;\n}\n\nexport function __testOnly_clearGitHubAppClient(): void {\n  singleton = null;\n}\n\nexport async function getAppJwt(): Promise<string> {\n  return getSingleton().getAppJwt();\n}\n\nexport async function getInstallationAccessToken(installationId: number): Promise<GitHubInstallationAccessToken> {\n  return getSingleton().getInstallationAccessToken(installationId);\n}\n\nexport async function getInstallationOctokit(installationId: number): Promise<Octokit> {\n  return getSingleton().getInstallationOctokit(installationId);\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/detect-framework.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/detection.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'params' is defined but never used.","line":11,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":85}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"type GitHubContentFile = {\n  type: \"file\";\n  encoding?: string;\n  content?: string;\n};\n\ntype GitHubContentResponse = { data: GitHubContentFile | { type: string } | unknown };\n\nexport type OctokitLike = {\n  repos: {\n    getContent: (params: { owner: string; repo: string; path: string; ref?: string }) => Promise<GitHubContentResponse>;\n  };\n};\n\nexport type PackageJson = {\n  dependencies?: Record<string, string>;\n  devDependencies?: Record<string, string>;\n  workspaces?: unknown;\n};\n\nexport type PackageJsonAnalysis = {\n  nextVersion: string | null;\n  existingAnalytics: string[];\n  hasWorkspaces: boolean;\n};\n\nexport type DetectedFramework = \"nextjs-app\" | \"nextjs-pages\" | null;\n\nexport type RouterDetectionResult = {\n  framework: DetectedFramework;\n  entryPoint: string | null;\n};\n\nconst ANALYTICS_PACKAGES = [\n  \"posthog-js\",\n  \"posthog-node\",\n  \"@amplitude/analytics-browser\",\n  \"mixpanel-browser\",\n  \"@segment/analytics-next\",\n  \"@vercel/analytics\",\n  \"plausible-tracker\",\n  \"@google-analytics/data\",\n  \"ga-4-react\",\n] as const;\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return typeof value === \"object\" && value !== null;\n}\n\nfunction isNotFoundError(error: unknown): boolean {\n  return isRecord(error) && error.status === 404;\n}\n\nfunction decodeGitHubFileContent(file: GitHubContentFile): string | null {\n  if (!file.content) return null;\n  if (!file.encoding || file.encoding === \"base64\") {\n    return Buffer.from(file.content, \"base64\").toString(\"utf8\");\n  }\n  return null;\n}\n\nasync function fetchTextFileIfExists(\n  octokit: OctokitLike,\n  owner: string,\n  repo: string,\n  path: string,\n  options?: { ref?: string },\n): Promise<string | null> {\n  try {\n    const response = await octokit.repos.getContent({ owner, repo, path, ref: options?.ref });\n    const data = response.data;\n    if (!isRecord(data) || data.type !== \"file\") return null;\n    return decodeGitHubFileContent(data as GitHubContentFile);\n  } catch (error) {\n    if (isNotFoundError(error)) return null;\n    throw error;\n  }\n}\n\nexport async function fetchPackageJson(\n  octokit: OctokitLike,\n  owner: string,\n  repo: string,\n  options?: { ref?: string },\n): Promise<PackageJson | null> {\n  try {\n    const response = await octokit.repos.getContent({ owner, repo, path: \"package.json\", ref: options?.ref });\n    const data = response.data;\n    if (!isRecord(data) || data.type !== \"file\") return null;\n    const content = decodeGitHubFileContent(data as GitHubContentFile);\n    if (!content) return null;\n    return JSON.parse(content) as PackageJson;\n  } catch (error) {\n    if (isNotFoundError(error)) return null;\n    throw error;\n  }\n}\n\nexport function analyzePackageJson(packageJson: PackageJson): PackageJsonAnalysis {\n  const dependencies = packageJson.dependencies ?? {};\n  const devDependencies = packageJson.devDependencies ?? {};\n  const allDeps = { ...dependencies, ...devDependencies };\n\n  const nextVersion = typeof allDeps.next === \"string\" ? allDeps.next : null;\n  const existingAnalytics = ANALYTICS_PACKAGES.filter((name) => typeof allDeps[name] === \"string\");\n  const hasWorkspaces = Array.isArray(packageJson.workspaces) || (isRecord(packageJson.workspaces) && packageJson.workspaces);\n\n  return { nextVersion, existingAnalytics: [...existingAnalytics], hasWorkspaces: Boolean(hasWorkspaces) };\n}\n\nexport async function fileExists(\n  octokit: OctokitLike,\n  owner: string,\n  repo: string,\n  path: string,\n  options?: { ref?: string },\n): Promise<boolean> {\n  try {\n    const response = await octokit.repos.getContent({ owner, repo, path, ref: options?.ref });\n    const data = response.data;\n    return isRecord(data) && data.type === \"file\";\n  } catch (error) {\n    if (isNotFoundError(error)) return false;\n    throw error;\n  }\n}\n\nexport async function findFirstExistingPath(\n  octokit: OctokitLike,\n  owner: string,\n  repo: string,\n  paths: string[],\n  options?: { ref?: string },\n): Promise<string | null> {\n  for (const path of paths) {\n    if (await fileExists(octokit, owner, repo, path, options)) return path;\n  }\n  return null;\n}\n\nconst APP_ROUTER_ENTRYPOINT_CANDIDATES = [\n  \"app/layout.tsx\",\n  \"app/layout.jsx\",\n  \"app/layout.js\",\n  \"src/app/layout.tsx\",\n  \"src/app/layout.jsx\",\n  \"src/app/layout.js\",\n];\n\nconst PAGES_ROUTER_ENTRYPOINT_CANDIDATES = [\n  \"pages/_app.tsx\",\n  \"pages/_app.jsx\",\n  \"pages/_app.js\",\n  \"src/pages/_app.tsx\",\n  \"src/pages/_app.jsx\",\n  \"src/pages/_app.js\",\n];\n\nconst MONOREPO_SENTINELS = [\"pnpm-workspace.yaml\", \"lerna.json\"] as const;\n\nfunction parsePnpmWorkspacePackages(yaml: string): string[] | null {\n  const lines = yaml\n    .split(\"\\n\")\n    .map((line) => line.replace(/\\r$/, \"\"))\n    .map((line) => line.replace(/#.*$/, \"\").trimEnd());\n\n  const packagesIndex = lines.findIndex((line) => line.trim() === \"packages:\");\n  if (packagesIndex === -1) return null;\n\n  const result: string[] = [];\n  for (let index = packagesIndex + 1; index < lines.length; index += 1) {\n    const raw = lines[index];\n    if (!raw) continue;\n\n    const trimmed = raw.trim();\n    if (!trimmed) continue;\n    if (!trimmed.startsWith(\"-\")) {\n      // We've exited the list (or hit another section).\n      if (result.length > 0) break;\n      continue;\n    }\n\n    const value = trimmed.replace(/^-+\\s*/, \"\").trim();\n    if (value) result.push(value);\n  }\n\n  return result.length > 0 ? result : null;\n}\n\nexport async function detectNextRouter(\n  octokit: OctokitLike,\n  owner: string,\n  repo: string,\n  options?: { ref?: string },\n): Promise<RouterDetectionResult> {\n  const appEntryPoint = await findFirstExistingPath(\n    octokit,\n    owner,\n    repo,\n    APP_ROUTER_ENTRYPOINT_CANDIDATES,\n    options,\n  );\n  if (appEntryPoint) return { framework: \"nextjs-app\", entryPoint: appEntryPoint };\n\n  const pagesEntryPoint = await findFirstExistingPath(\n    octokit,\n    owner,\n    repo,\n    PAGES_ROUTER_ENTRYPOINT_CANDIDATES,\n    options,\n  );\n  if (pagesEntryPoint) return { framework: \"nextjs-pages\", entryPoint: pagesEntryPoint };\n\n  return { framework: null, entryPoint: null };\n}\n\nexport async function detectMonorepo(\n  octokit: OctokitLike,\n  owner: string,\n  repo: string,\n  packageJson: PackageJson,\n  options?: { ref?: string },\n): Promise<boolean> {\n  const analysis = analyzePackageJson(packageJson);\n  if (analysis.hasWorkspaces) return true;\n\n  const pnpmWorkspace = await fetchTextFileIfExists(octokit, owner, repo, \"pnpm-workspace.yaml\", options);\n  if (pnpmWorkspace) {\n    const packages = parsePnpmWorkspacePackages(pnpmWorkspace);\n    // `create-next-app` can generate a workspace file with `packages: ['.']` even for single-package repos.\n    // Treat that case as non-monorepo to avoid incorrectly marking such repos as unsupported.\n    if (!packages) return true;\n    const nonRootPackages = packages.filter((entry) => entry !== \".\" && entry !== \"./\");\n    if (nonRootPackages.length > 0) return true;\n  }\n\n  for (const sentinel of MONOREPO_SENTINELS) {\n    if (sentinel === \"pnpm-workspace.yaml\") continue;\n    if (await fileExists(octokit, owner, repo, sentinel, options)) return true;\n  }\n\n  return false;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/generate.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/handlers/installation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/handlers/pull-request.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/handlers/push.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/pr-generator.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'params' is defined but never used.","line":16,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":50},{"ruleId":"no-unused-vars","severity":2,"message":"'params' is defined but never used.","line":17,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":85},{"ruleId":"no-unused-vars","severity":2,"message":"'params' is defined but never used.","line":18,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":6},{"ruleId":"no-unused-vars","severity":2,"message":"'params' is defined but never used.","line":29,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":66},{"ruleId":"no-unused-vars","severity":2,"message":"'params' is defined but never used.","line":30,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":82},{"ruleId":"no-unused-vars","severity":2,"message":"'params' is defined but never used.","line":198,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":205,"endColumn":6},{"ruleId":"no-unused-vars","severity":2,"message":"'params' is defined but never used.","line":206,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":99}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { renderAppRouterAnalyticsComponent } from \"./templates/app-router\";\nimport { renderPagesRouterAnalyticsHook } from \"./templates/pages-router\";\nimport { hasAtAlias, resolveAnalyticsPaths } from \"./templates/paths\";\nimport { insertAnalyticsIntoAppRouterLayout, insertAnalyticsIntoPagesRouterApp } from \"./templates/insert-analytics\";\nimport { setProjectPullRequestByRepoId } from \"../db/queries/projects\";\n\ntype OctokitResponse<T> = { data: T };\n\ntype RepoResponse = OctokitResponse<{ default_branch: string }>;\ntype RefResponse = OctokitResponse<{ object: { sha: string } }>;\n\ntype ContentResponse = OctokitResponse<unknown>;\n\nexport type PrOctokitLike = {\n  repos: {\n    get: (params: { owner: string; repo: string }) => Promise<RepoResponse>;\n    getContent: (params: { owner: string; repo: string; path: string; ref?: string }) => Promise<ContentResponse>;\n    createOrUpdateFileContents: (params: {\n      owner: string;\n      repo: string;\n      branch: string;\n      path: string;\n      message: string;\n      content: string;\n      sha?: string;\n    }) => Promise<unknown>;\n  };\n  git: {\n    getRef: (params: { owner: string; repo: string; ref: string }) => Promise<RefResponse>;\n    createRef: (params: { owner: string; repo: string; ref: string; sha: string }) => Promise<unknown>;\n  };\n};\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return typeof value === \"object\" && value !== null;\n}\n\nfunction isBranchExistsError(error: unknown): boolean {\n  return isRecord(error) && error.status === 422;\n}\n\nconst BRANCH_PREFIX = \"add-fast-pr-analytics\";\n\nexport async function createAnalyticsBranch(\n  octokit: PrOctokitLike,\n  params: { owner: string; repo: string },\n): Promise<string> {\n  const { data: repoData } = await octokit.repos.get({ owner: params.owner, repo: params.repo });\n  const defaultBranch = repoData.default_branch;\n\n  const { data: ref } = await octokit.git.getRef({\n    owner: params.owner,\n    repo: params.repo,\n    ref: `heads/${defaultBranch}`,\n  });\n  const baseSha = ref.object.sha;\n\n  for (let suffix = 1; suffix < 1000; suffix += 1) {\n    const branchName = suffix === 1 ? BRANCH_PREFIX : `${BRANCH_PREFIX}-${suffix}`;\n    try {\n      await octokit.git.createRef({\n        owner: params.owner,\n        repo: params.repo,\n        ref: `refs/heads/${branchName}`,\n        sha: baseSha,\n      });\n      return branchName;\n    } catch (error) {\n      if (isBranchExistsError(error)) continue;\n      throw error;\n    }\n  }\n\n  throw new Error(`Failed to create a unique analytics branch after 999 attempts (prefix: ${BRANCH_PREFIX})`);\n}\n\nfunction isNotFoundError(error: unknown): boolean {\n  return isRecord(error) && error.status === 404;\n}\n\nasync function fetchJsonFileIfExists(\n  octokit: PrOctokitLike,\n  params: { owner: string; repo: string; path: string; ref?: string },\n): Promise<unknown | null> {\n  try {\n    const response = await octokit.repos.getContent(params);\n    const file = response.data;\n    if (!isRecord(file) || file.type !== \"file\" || typeof file.content !== \"string\") return null;\n    const text = Buffer.from(file.content, \"base64\").toString(\"utf8\");\n    return JSON.parse(text) as unknown;\n  } catch (error) {\n    if (isNotFoundError(error)) return null;\n    throw error;\n  }\n}\n\nasync function fetchTextFile(\n  octokit: PrOctokitLike,\n  params: { owner: string; repo: string; path: string; ref?: string },\n): Promise<{ sha: string; content: string }> {\n  const response = await octokit.repos.getContent(params);\n  const file = response.data;\n  if (!isRecord(file) || file.type !== \"file\") {\n    throw new Error(`Expected GitHub content at ${params.path} to be a file`);\n  }\n  if (typeof file.sha !== \"string\" || file.sha.length === 0) {\n    throw new Error(`Expected GitHub content at ${params.path} to include a sha`);\n  }\n  const content = typeof file.content === \"string\" ? Buffer.from(file.content, \"base64\").toString(\"utf8\") : \"\";\n  return { sha: file.sha, content };\n}\n\nfunction encodeBase64(text: string): string {\n  return Buffer.from(text, \"utf8\").toString(\"base64\");\n}\n\nexport async function commitAnalyticsFiles(\n  octokit: PrOctokitLike,\n  params: {\n    owner: string;\n    repo: string;\n    branch: string;\n    defaultBranch: string;\n    projectId: string;\n    detection: { framework: \"nextjs-app\" | \"nextjs-pages\"; entryPoint: string };\n    eventsUrl: string;\n  },\n): Promise<{ componentFilePath: string }> {\n  const tsconfig =\n    (await fetchJsonFileIfExists(octokit, {\n      owner: params.owner,\n      repo: params.repo,\n      path: \"tsconfig.json\",\n      ref: params.defaultBranch,\n    })) ??\n    (await fetchJsonFileIfExists(octokit, {\n      owner: params.owner,\n      repo: params.repo,\n      path: \"jsconfig.json\",\n      ref: params.defaultBranch,\n    }));\n\n  const useAtAlias = tsconfig ? hasAtAlias(tsconfig) : false;\n  const paths = resolveAnalyticsPaths({ entryPointPath: params.detection.entryPoint, useAtAlias });\n\n  const componentContent =\n    params.detection.framework === \"nextjs-app\"\n      ? renderAppRouterAnalyticsComponent({ projectId: params.projectId, eventsUrl: params.eventsUrl })\n      : renderPagesRouterAnalyticsHook({ projectId: params.projectId, eventsUrl: params.eventsUrl });\n\n  await octokit.repos.createOrUpdateFileContents({\n    owner: params.owner,\n    repo: params.repo,\n    branch: params.branch,\n    path: paths.componentFilePath,\n    message: `Add Fast PR Analytics component`,\n    content: encodeBase64(componentContent),\n  });\n\n  const entryPointFile = await fetchTextFile(octokit, {\n    owner: params.owner,\n    repo: params.repo,\n    path: params.detection.entryPoint,\n    ref: params.defaultBranch,\n  });\n\n  const updatedEntryPointContent =\n    params.detection.framework === \"nextjs-app\"\n      ? insertAnalyticsIntoAppRouterLayout({\n          content: entryPointFile.content,\n          importPath: paths.importPath,\n          componentName: \"FastPrAnalytics\",\n        })\n      : insertAnalyticsIntoPagesRouterApp({\n          content: entryPointFile.content,\n          importPath: paths.importPath,\n          hookName: \"useFastPrAnalytics\",\n        });\n\n  await octokit.repos.createOrUpdateFileContents({\n    owner: params.owner,\n    repo: params.repo,\n    branch: params.branch,\n    path: params.detection.entryPoint,\n    message: `Add Fast PR Analytics to ${params.detection.entryPoint}`,\n    content: encodeBase64(updatedEntryPointContent),\n    sha: entryPointFile.sha,\n  });\n\n  return { componentFilePath: paths.componentFilePath };\n}\n\ntype PullResponse = OctokitResponse<{ number: number; html_url: string }>;\ntype PullListResponse = OctokitResponse<Array<{ number: number; html_url: string }>>;\n\nexport type PullsOctokitLike = {\n  pulls: {\n    create: (params: {\n      owner: string;\n      repo: string;\n      title: string;\n      head: string;\n      base: string;\n      body: string;\n    }) => Promise<PullResponse>;\n    list: (params: { owner: string; repo: string; head: string; state: \"open\" | \"closed\" | \"all\" }) => Promise<PullListResponse>;\n  };\n};\n\nfunction generatePrBody(params: { projectId: string; entryPoint: string }): string {\n  return [\n    \"This PR adds Fast PR Analytics for automatic page view tracking.\",\n    \"\",\n    \"## Changes\",\n    `- Added analytics component in \\`components/fast-pr-analytics.tsx\\``,\n    `- Added initialization in \\`${params.entryPoint}\\``,\n    \"\",\n    \"## What happens next\",\n    \"1. Review and merge this PR\",\n    \"2. Deploy via your normal process\",\n    `3. Visit ${process.env.NEXT_PUBLIC_APP_URL ?? \"https://app.productname.com\"}/projects/${params.projectId} to see your analytics`,\n  ].join(\"\\n\");\n}\n\nexport async function openAnalyticsPullRequest(\n  octokit: PullsOctokitLike,\n  params: {\n    repoId: bigint;\n    owner: string;\n    repo: string;\n    branch: string;\n    defaultBranch: string;\n    projectId: string;\n    entryPoint: string;\n  },\n): Promise<{ prNumber: number; prUrl: string; alreadyExists: boolean }> {\n  const title = \"Add Fast PR Analytics\";\n  const body = generatePrBody({ projectId: params.projectId, entryPoint: params.entryPoint });\n\n  try {\n    const { data: pr } = await octokit.pulls.create({\n      owner: params.owner,\n      repo: params.repo,\n      title,\n      head: params.branch,\n      base: params.defaultBranch,\n      body,\n    });\n\n    await setProjectPullRequestByRepoId({ repoId: params.repoId, prNumber: pr.number, prUrl: pr.html_url });\n    return { prNumber: pr.number, prUrl: pr.html_url, alreadyExists: false };\n  } catch (error) {\n    if (!isBranchExistsError(error)) throw error;\n\n    const { data: prs } = await octokit.pulls.list({\n      owner: params.owner,\n      repo: params.repo,\n      head: `${params.owner}:${params.branch}`,\n      state: \"open\",\n    });\n    const existing = prs[0];\n    if (!existing) throw new Error(`PR already exists for branch ${params.branch}, but no open PR was found`);\n\n    await setProjectPullRequestByRepoId({ repoId: params.repoId, prNumber: existing.number, prUrl: existing.html_url });\n    return { prNumber: existing.number, prUrl: existing.html_url, alreadyExists: true };\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/templates/app-router.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/templates/insert-analytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/templates/pages-router.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/templates/paths.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/github/webhook-verify.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/hooks/use-live-feed.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/hooks/use-project.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/hooks/use-projects.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/providers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/stripe/client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/stripe/constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/stripe/plans.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/lib/tinybird/client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/next-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/next.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/playwright.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/scripts/link-github-users.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/analytics-live-feed-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/analytics-overview-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/analytics-sessions-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/app-url.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/dashboard-data-fetching.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":11,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":11,"endColumn":94}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it, vi } from \"vitest\";\n\nimport Providers from \"../lib/providers\";\nimport { fetchProject } from \"../lib/hooks/use-project\";\n\ndescribe(\"dashboard data fetching\", () => {\n  it(\"renders a React Query provider wrapper\", () => {\n    const html = renderToStaticMarkup(\n      React.createElement(Providers, { children: React.createElement(\"div\", null, \"Hello\") }),\n    );\n    expect(html).toContain(\"Hello\");\n  });\n\n  it(\"fetchProject calls /api/projects/:id and returns JSON\", async () => {\n    const fetchSpy = vi.spyOn(globalThis, \"fetch\").mockResolvedValue({\n      ok: true,\n      json: async () => ({ project: { id: \"proj_test\" } }),\n    } as unknown as Response);\n\n    try {\n      const result = await fetchProject(\"proj_test\");\n      expect(fetchSpy).toHaveBeenCalledWith(\"/api/projects/proj_test\", expect.any(Object));\n      expect(result).toEqual({ project: { id: \"proj_test\" } });\n    } finally {\n      fetchSpy.mockRestore();\n    }\n  });\n\n  it(\"fetchProject throws a helpful error on non-2xx responses\", async () => {\n    const fetchSpy = vi.spyOn(globalThis, \"fetch\").mockResolvedValue({\n      ok: false,\n      json: async () => ({ error: \"Unauthorized\" }),\n    } as unknown as Response);\n\n    try {\n      await expect(fetchProject(\"proj_test\")).rejects.toThrow(\"Unauthorized\");\n    } finally {\n      fetchSpy.mockRestore();\n    }\n  });\n});\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/dashboard-header.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/dashboard-page.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/dashboard-shell.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/design-system-tailwind.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/detect-framework.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/drizzle-env.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/e2e-login.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/env.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-app-scaffold.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-project-cache.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-tinybird-client.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-track-route-cors.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-track-route-project-validation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-track-route-v2-schema.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/events-track-route.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/get-user.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-analyze.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-app.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'args' is defined but never used.","line":8,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":30},{"ruleId":"no-unused-vars","severity":2,"message":"'_options' is defined but never used.","line":23,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":34}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, expect, it, vi } from \"vitest\";\n\nlet capturedAppOptions: unknown;\nlet appAuthSpy: ReturnType<typeof vi.fn> | undefined;\n\nvi.mock(\"@octokit/app\", () => ({\n  App: class App {\n    octokit: { auth: (...args: unknown[]) => unknown };\n    constructor(options: unknown) {\n      capturedAppOptions = options;\n      this.octokit = {\n        auth: (...args: unknown[]) => {\n          if (!appAuthSpy) throw new Error(\"appAuthSpy not initialized\");\n          return appAuthSpy(...args);\n        },\n      };\n    }\n  },\n}));\n\nvi.mock(\"@octokit/rest\", () => ({\n  Octokit: class Octokit {\n    constructor(_options: unknown) {}\n  },\n}));\n\ndescribe(\"github app client\", () => {\n  it(\"creates GitHub App client using env appId/privateKey and can generate an app JWT\", async () => {\n    const previousAppId = process.env.GITHUB_APP_ID;\n    const previousPrivateKey = process.env.GITHUB_APP_PRIVATE_KEY;\n\n    process.env.GITHUB_APP_ID = \"123\";\n    process.env.GITHUB_APP_PRIVATE_KEY = \"-----BEGIN PRIVATE KEY-----\\\\nabc\\\\n-----END PRIVATE KEY-----\\\\n\";\n\n    vi.resetModules();\n    appAuthSpy = vi.fn().mockResolvedValue({ token: \"header.payload.signature\" });\n\n    const { __testOnly_clearGitHubAppClient, getAppJwt } = await import(\"../lib/github/app\");\n    __testOnly_clearGitHubAppClient();\n\n    await expect(getAppJwt()).resolves.toBe(\"header.payload.signature\");\n\n    expect(capturedAppOptions).toEqual(\n      expect.objectContaining({\n        appId: 123,\n        privateKey: \"-----BEGIN PRIVATE KEY-----\\nabc\\n-----END PRIVATE KEY-----\\n\",\n      }),\n    );\n    expect(appAuthSpy).toHaveBeenCalledWith({ type: \"app\" });\n\n    if (previousAppId === undefined) delete process.env.GITHUB_APP_ID;\n    else process.env.GITHUB_APP_ID = previousAppId;\n    if (previousPrivateKey === undefined) delete process.env.GITHUB_APP_PRIVATE_KEY;\n    else process.env.GITHUB_APP_PRIVATE_KEY = previousPrivateKey;\n  });\n\n  it(\"caches installation tokens and refreshes before expiry\", async () => {\n    vi.resetModules();\n    const { createGitHubAppClient } = await import(\"../lib/github/app\");\n\n    const nowSpy = vi.fn();\n    nowSpy.mockReturnValueOnce(0).mockReturnValueOnce(59_500).mockReturnValueOnce(60_001);\n\n    const authSpy = vi\n      .fn()\n      .mockResolvedValueOnce({ token: \"t1\", expiresAt: new Date(60_000).toISOString() })\n      .mockResolvedValueOnce({ token: \"t2\", expiresAt: new Date(180_000).toISOString() });\n\n    const client = createGitHubAppClient({\n      appId: 123,\n      privateKey: \"key\",\n      auth: authSpy,\n      now: nowSpy,\n      createOctokit: () => ({}) as never,\n    });\n\n    await expect(client.getInstallationAccessToken(1)).resolves.toEqual({\n      token: \"t1\",\n      expiresAt: new Date(60_000).toISOString(),\n    });\n    await expect(client.getInstallationAccessToken(1)).resolves.toEqual({\n      token: \"t1\",\n      expiresAt: new Date(60_000).toISOString(),\n    });\n    await expect(client.getInstallationAccessToken(1)).resolves.toEqual({\n      token: \"t2\",\n      expiresAt: new Date(180_000).toISOString(),\n    });\n    await expect(client.getInstallationAccessToken(1)).resolves.toEqual({\n      token: \"t2\",\n      expiresAt: new Date(180_000).toISOString(),\n    });\n\n    expect(authSpy).toHaveBeenCalledTimes(2);\n    expect(authSpy).toHaveBeenNthCalledWith(1, { type: \"installation\", installationId: 1 });\n    expect(authSpy).toHaveBeenNthCalledWith(2, { type: \"installation\", installationId: 1 });\n  });\n\n  it(\"getInstallationOctokit(installationId) returns an Octokit client\", async () => {\n    vi.resetModules();\n    const { createGitHubAppClient } = await import(\"../lib/github/app\");\n\n    const authSpy = vi.fn().mockResolvedValue({ token: \"t1\", expiresAt: new Date(60_000).toISOString() });\n    const createOctokitSpy = vi.fn().mockReturnValue({ ok: true });\n\n    const client = createGitHubAppClient({\n      appId: 123,\n      privateKey: \"key\",\n      auth: authSpy,\n      now: () => 0,\n      createOctokit: createOctokitSpy as never,\n    });\n\n    await expect(client.getInstallationOctokit(999)).resolves.toEqual({ ok: true });\n    expect(createOctokitSpy).toHaveBeenCalledWith({ auth: \"t1\" });\n  });\n\n  it(\"throws a clear error for an invalid GITHUB_APP_ID\", async () => {\n    const previousAppId = process.env.GITHUB_APP_ID;\n    const previousPrivateKey = process.env.GITHUB_APP_PRIVATE_KEY;\n    process.env.GITHUB_APP_ID = \"not-a-number\";\n    process.env.GITHUB_APP_PRIVATE_KEY = \"key\";\n\n    vi.resetModules();\n    const { __testOnly_clearGitHubAppClient, getAppJwt } = await import(\"../lib/github/app\");\n    __testOnly_clearGitHubAppClient();\n\n    await expect(getAppJwt()).rejects.toThrow(/Invalid GITHUB_APP_ID/);\n\n    if (previousAppId === undefined) delete process.env.GITHUB_APP_ID;\n    else process.env.GITHUB_APP_ID = previousAppId;\n    if (previousPrivateKey === undefined) delete process.env.GITHUB_APP_PRIVATE_KEY;\n    else process.env.GITHUB_APP_PRIVATE_KEY = previousPrivateKey;\n  });\n\n  it(\"throws when installation auth response is missing expiresAt\", async () => {\n    vi.resetModules();\n    const { createGitHubAppClient } = await import(\"../lib/github/app\");\n\n    const authSpy = vi.fn().mockResolvedValue({ token: \"t1\" });\n    const client = createGitHubAppClient({\n      appId: 123,\n      privateKey: \"key\",\n      auth: authSpy,\n      now: () => 0,\n      createOctokit: () => ({}) as never,\n    });\n\n    await expect(client.getInstallationAccessToken(1)).rejects.toThrow(/missing expiresAt/);\n  });\n\n  it(\"throws when installation auth response has an invalid expiresAt\", async () => {\n    vi.resetModules();\n    const { createGitHubAppClient } = await import(\"../lib/github/app\");\n\n    const authSpy = vi.fn().mockResolvedValue({ token: \"t1\", expiresAt: \"not-a-date\" });\n    const client = createGitHubAppClient({\n      appId: 123,\n      privateKey: \"key\",\n      auth: authSpy,\n      now: () => 0,\n      createOctokit: () => ({}) as never,\n    });\n\n    await expect(client.getInstallationAccessToken(1)).rejects.toThrow(/invalid expiresAt/);\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-callback-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-detection.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-generate-events-url.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-generate.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-insertion.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-oauth-callback.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-oauth-redirect.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-oauth.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-templates.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-tokens.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-webhook-installation-handler.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-webhook-pull-request-handler.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-webhook-push-handler.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/github-webhooks-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/link-github-users-script.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/live-event.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/live-feed-page.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":19,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":22,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":46,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":49,"endColumn":9}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it } from \"vitest\";\n\nimport LiveFeedPage from \"../app/(dashboard)/projects/[id]/live/page\";\nimport { LIVE_FEED_REFETCH_INTERVAL_MS } from \"../lib/hooks/use-live-feed\";\n\ndescribe(\"/projects/[id]/live page\", () => {\n  it(\"polls every 5 seconds\", () => {\n    expect(LIVE_FEED_REFETCH_INTERVAL_MS).toBe(5000);\n  });\n\n  it(\"renders an empty state when there are no events\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"live-feed\", \"proj_123\"], { events: [], hasMore: false });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(LiveFeedPage, { params: { id: \"proj_123\" } }),\n      }),\n    );\n\n    expect(html).toContain(\"Live Feed\");\n    expect(html).toContain(\"No events yet\");\n  });\n\n  it(\"renders recent events\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"live-feed\", \"proj_123\"], {\n      events: [\n        {\n          id: \"e1\",\n          eventType: \"page_view\",\n          path: \"/\",\n          referrer: null,\n          timestamp: \"2025-01-01T00:00:00.000Z\",\n          relativeTime: \"3 seconds ago\",\n        },\n      ],\n      hasMore: false,\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(LiveFeedPage, { params: { id: \"proj_123\" } }),\n      }),\n    );\n\n    expect(html).toContain(\"page_view\");\n    expect(html).toContain(\"/\");\n    expect(html).toContain(\"3 seconds ago\");\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/login-page-oauth.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/logout-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/logout-no-cookie.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-copy.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-docs-pages.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-footer-links.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-landing-page.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-legal-pages.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/marketing-pricing-page.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it, vi } from \"vitest\";\n\nlet cookieGetSpy: ReturnType<typeof vi.fn> | undefined;\nlet selectSpy: ReturnType<typeof vi.fn> | undefined;\n\nvi.mock(\"next/headers\", () => ({\n  cookies: () => ({\n    get: (...args: unknown[]) => {\n      if (!cookieGetSpy) throw new Error(\"cookieGetSpy not initialized\");\n      return cookieGetSpy(...args);\n    },\n  }),\n}));\n\nvi.mock(\"../lib/db/client\", () => ({\n  db: {\n    select: (...args: unknown[]) => {\n      if (!selectSpy) throw new Error(\"selectSpy not initialized\");\n      return selectSpy(...args);\n    },\n  },\n}));\n\ndescribe(\"marketing pricing page\", () => {\n  it(\"renders Free, Pro, and Team tiers with event limits\", async () => {\n    vi.resetModules();\n\n    cookieGetSpy = vi.fn().mockReturnValue(null);\n    selectSpy = vi.fn();\n\n    const { default: PricingPage } = await import(\"../app/(marketing)/pricing/page\");\n    const element = await PricingPage();\n    const html = renderToStaticMarkup(element);\n\n    expect(html).toContain(\"Free\");\n    expect(html).toContain(\"Pro\");\n    expect(html).toContain(\"Team\");\n\n    expect(html).toContain(\"10,000 events/mo\");\n    expect(html).toContain(\"100,000 events/mo\");\n    expect(html).toContain(\"1,000,000 events/mo\");\n  });\n\n  it(\"renders a feature comparison section\", async () => {\n    vi.resetModules();\n    cookieGetSpy = vi.fn().mockReturnValue(null);\n    selectSpy = vi.fn();\n\n    const { default: PricingPage } = await import(\"../app/(marketing)/pricing/page\");\n    const element = await PricingPage();\n    const html = renderToStaticMarkup(element);\n    expect(html).toContain(\"Compare plans\");\n    expect(html).toContain(\"Projects\");\n    expect(html).toContain(\"Retention\");\n    expect(html).toContain(\"Support\");\n  });\n\n  it(\"links logged-out users to /api/auth/github for sign in\", async () => {\n    vi.resetModules();\n\n    cookieGetSpy = vi.fn().mockReturnValue(null);\n    selectSpy = vi.fn();\n\n    const { default: PricingPage } = await import(\"../app/(marketing)/pricing/page\");\n    const element = await PricingPage();\n    const html = renderToStaticMarkup(element);\n\n    expect(html).toContain('href=\"/api/auth/github\"');\n  });\n\n  it(\"renders checkout CTAs when a free user is logged in\", async () => {\n    vi.resetModules();\n\n    cookieGetSpy = vi.fn().mockReturnValue({ value: \"sess_123\" });\n\n    const sessionWhereSpy = vi.fn().mockResolvedValue([{ userId: \"u1\", expiresAt: new Date(\"2030-01-01T00:00:00.000Z\") }]);\n    const sessionFromSpy = vi.fn(() => ({ where: sessionWhereSpy }));\n\n    const userWhereSpy = vi.fn().mockResolvedValue([{ plan: \"free\" }]);\n    const userFromSpy = vi.fn(() => ({ where: userWhereSpy }));\n\n    selectSpy = vi\n      .fn()\n      .mockImplementationOnce(() => ({ from: sessionFromSpy }))\n      .mockImplementationOnce(() => ({ from: userFromSpy }));\n\n    const { default: PricingPage } = await import(\"../app/(marketing)/pricing/page\");\n    const element = await PricingPage();\n    const html = renderToStaticMarkup(element);\n\n    expect(html).toContain('action=\"/api/stripe/checkout\"');\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/middleware.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/migrations.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/overview-page.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":20,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":23,"endColumn":9}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it } from \"vitest\";\n\nimport OverviewPage from \"../app/(dashboard)/projects/[id]/overview/page\";\n\ndescribe(\"/projects/[id]/overview page\", () => {\n  it(\"renders summary stats and top lists from cached query data\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"overview\", \"proj_123\", \"7d\"], {\n      period: \"7d\",\n      pageViews: { total: 30, change: 100, timeSeries: [{ date: \"2025-01-01\", count: 30 }] },\n      sessions: { total: 5, change: -50 },\n      topPages: [{ path: \"/\", views: 20, percentage: 66.67 }],\n      topReferrers: [{ referrer: \"Direct\", count: 5, percentage: 100 }],\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(OverviewPage, { params: { id: \"proj_123\" } }),\n      }),\n    );\n\n    expect(html).toContain(\"Overview\");\n    expect(html).toContain(\"Page views\");\n    expect(html).toContain(\"30\");\n    expect(html).toContain(\"Sessions\");\n    expect(html).toContain(\"5\");\n    expect(html).toContain(\"Top pages\");\n    expect(html).toContain(\"Top referrers\");\n    expect(html).toContain(\"Direct\");\n  });\n});\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/pr-generator.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/project-detail-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/project-detail-page.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":32,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":35,"endColumn":9}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it } from \"vitest\";\n\nimport ProjectDetailPage from \"../app/(dashboard)/projects/[id]/page\";\n\ndescribe(\"/projects/[id] page\", () => {\n  it(\"renders the repo name, PR link, onboarding checklist, and regenerate button when eligible\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"analysis_failed\",\n        prNumber: 1,\n        prUrl: \"https://github.com/octo/repo/pull/1\",\n        detectedFramework: \"nextjs-app\",\n        detectedAnalytics: [],\n        eventsThisMonth: 0,\n        lastEventAt: null,\n        createdAt: \"2024-01-01T00:00:00.000Z\",\n        updatedAt: \"2024-01-01T00:00:00.000Z\",\n      },\n      quotaLimit: 10000,\n      quotaUsed: 0,\n      isOverQuota: false,\n      userPlan: \"free\",\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(ProjectDetailPage, { params: { id: \"proj_123\" } }),\n      }),\n    );\n\n    expect(html).toContain(\"octo/repo\");\n    expect(html).toContain('href=\"https://github.com/octo/repo/pull/1\"');\n    expect(html).toContain(\"Getting Started\");\n    expect(html).toContain(\"Re-run Analysis\"); // Button text changed from \"Regenerate PR\"\n    expect(html).toContain(\"Analysis Failed\"); // Status-specific card for failed state\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/project-layout.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":24,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":30,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":26,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":29,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":48,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":54,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":50,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":53,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":71,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":77,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":73,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":76,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":94,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":100,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":96,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":99,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":117,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":123,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":119,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":122,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":140,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":146,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":142,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":145,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":163,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":172,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":165,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":171,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":190,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":196,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":192,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":195,"endColumn":10},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":213,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":219,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":215,"column":19,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":218,"endColumn":10}],"suppressedMessages":[],"errorCount":18,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it, vi } from \"vitest\";\n\nvi.mock(\"next/navigation\", () => ({\n  usePathname: () => \"/projects/proj_123\",\n}));\n\nimport ProjectLayout from \"../app/(dashboard)/projects/[id]/layout\";\n\ndescribe(\"project layout\", () => {\n  it(\"renders breadcrumb with Projects link\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_123\" }, children: React.createElement(\"div\", { \"data-testid\": \"child\" }, \"Child content\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain('href=\"/projects\"');\n    expect(html).toContain(\"Projects\");\n  });\n\n  it(\"renders project name from data\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_123\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"octo/repo\");\n  });\n\n  it(\"renders status badge when status is available\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_123\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"Active\");\n  });\n\n  it(\"renders tab navigation with correct links\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_123\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain('href=\"/projects/proj_123\"');\n    expect(html).toContain('href=\"/projects/proj_123/overview\"');\n    expect(html).toContain('href=\"/projects/proj_123/live\"');\n    expect(html).toContain('href=\"/projects/proj_123/sessions\"');\n    expect(html).toContain(\"Overview\");\n    expect(html).toContain(\"Analytics\");\n    expect(html).toContain(\"Live Feed\");\n    expect(html).toContain(\"Sessions\");\n  });\n\n  it(\"renders skeleton when data is pending\", () => {\n    const queryClient = new QueryClient();\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_456\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"animate-shimmer\");\n  });\n\n  it(\"renders project ID as fallback when repo name is not available\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_789\"], {\n      project: {\n        id: \"proj_789\",\n        githubRepoFullName: null,\n        status: \"pending\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_789\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"proj_789\");\n  });\n\n  it(\"renders children content\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          {\n            params: { id: \"proj_123\" },\n            children: React.createElement(\"div\", { className: \"test-child\" }, \"My child content\"),\n          },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"My child content\");\n    expect(html).toContain(\"test-child\");\n  });\n\n  it(\"highlights the active tab based on pathname\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_123\"], {\n      project: {\n        id: \"proj_123\",\n        githubRepoFullName: \"octo/repo\",\n        status: \"active\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_123\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"bg-slate-900\");\n  });\n\n  it(\"renders different statuses correctly\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"project\", \"proj_analyzing\"], {\n      project: {\n        id: \"proj_analyzing\",\n        githubRepoFullName: \"user/analyzing-repo\",\n        status: \"analyzing\",\n      },\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(\n          ProjectLayout,\n          { params: { id: \"proj_analyzing\" }, children: React.createElement(\"div\", null, \"Child\") },\n        ),\n      }),\n    );\n\n    expect(html).toContain(\"Analyzing\");\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/project-polling.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/projects-list-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/projects-list-page.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":19,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":22,"endColumn":9},{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":47,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":50,"endColumn":9}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it } from \"vitest\";\n\nimport ProjectsPage from \"../app/(dashboard)/projects/page\";\nimport { PROJECT_LIST_REFETCH_INTERVAL_MS } from \"../lib/hooks/use-projects\";\n\ndescribe(\"/projects page\", () => {\n  it(\"configures polling every 10 seconds\", () => {\n    expect(PROJECT_LIST_REFETCH_INTERVAL_MS).toBe(10_000);\n  });\n\n  it(\"renders an empty state when there are no projects\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"projects\"], { projects: [] });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(ProjectsPage),\n      }),\n    );\n\n    expect(html).toContain(\"Projects\");\n    expect(html).toContain(\"No projects yet\");\n  });\n\n  it(\"renders project cards that link to the detail page\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"projects\"], {\n      projects: [\n        {\n          id: \"proj_123\",\n          githubRepoFullName: \"octo/repo\",\n          status: \"active\",\n          prUrl: null,\n          detectedFramework: \"nextjs-app\",\n          eventsThisMonth: 0,\n          lastEventAt: null,\n          createdAt: \"2024-01-01T00:00:00.000Z\",\n        },\n      ],\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(ProjectsPage),\n      }),\n    );\n\n    expect(html).toContain(\"octo/repo\");\n    expect(html).toContain('href=\"/projects/proj_123\"');\n    expect(html).toContain(\"Active\");\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/projects-queries.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/quota-display.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/regenerate-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/regenerate-requests-queries.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/root-layout-metadata.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/schema.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/session.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/sessions-page.test.ts","messages":[{"ruleId":"react/no-children-prop","severity":2,"message":"Do not pass children as props. Instead, pass them as additional arguments to React.createElement.","line":23,"column":7,"nodeType":"CallExpression","messageId":"passChildrenAsArgs","endLine":26,"endColumn":9}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it } from \"vitest\";\n\nimport SessionsPage from \"../app/(dashboard)/projects/[id]/sessions/page\";\n\ndescribe(\"/projects/[id]/sessions page\", () => {\n  it(\"renders summary stats and chart from cached query data\", () => {\n    const queryClient = new QueryClient();\n    queryClient.setQueryData([\"sessions\", \"proj_123\", \"7d\"], {\n      period: \"7d\",\n      totalSessions: 5,\n      newVisitors: 5,\n      returningVisitors: 0,\n      timeSeries: [\n        { date: \"2025-01-01\", newSessions: 2, returningSessions: 0 },\n        { date: \"2025-01-02\", newSessions: 3, returningSessions: 0 },\n      ],\n    });\n\n    const html = renderToStaticMarkup(\n      React.createElement(QueryClientProvider, {\n        client: queryClient,\n        children: React.createElement(SessionsPage, { params: { id: \"proj_123\" } }),\n      }),\n    );\n\n    expect(html).toContain(\"Sessions\");\n    expect(html).toContain(\"Total sessions\");\n    expect(html).toContain(\"5\");\n    expect(html).toContain(\"New visitors\");\n    expect(html).toContain(\"Returning visitors\");\n  });\n});\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/settings-page.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { describe, expect, it, vi } from \"vitest\";\n\nlet cookieGetSpy: ReturnType<typeof vi.fn> | undefined;\nlet selectSpy: ReturnType<typeof vi.fn> | undefined;\n\nvi.mock(\"next/headers\", () => ({\n  cookies: () => ({\n    get: (...args: unknown[]) => {\n      if (!cookieGetSpy) throw new Error(\"cookieGetSpy not initialized\");\n      return cookieGetSpy(...args);\n    },\n  }),\n}));\n\nvi.mock(\"../lib/db/client\", () => ({\n  db: {\n    select: (...args: unknown[]) => {\n      if (!selectSpy) throw new Error(\"selectSpy not initialized\");\n      return selectSpy(...args);\n    },\n  },\n}));\n\nvi.mock(\"../app/(dashboard)/settings/stripe-reconcile-client\", () => ({\n  StripeReconcileClient: () => null,\n}));\n\ndescribe(\"/settings page\", () => {\n  it(\"renders email, plan, and a logout form\", async () => {\n    vi.resetModules();\n\n    cookieGetSpy = vi.fn().mockReturnValue({ value: \"sess_123\" });\n\n    const sessionWhereSpy = vi.fn().mockResolvedValue([{ userId: \"u1\", expiresAt: new Date(\"2030-01-01T00:00:00.000Z\") }]);\n    const sessionFromSpy = vi.fn(() => ({ where: sessionWhereSpy }));\n\n    const userWhereSpy = vi.fn().mockResolvedValue([\n      {\n        email: \"u1@example.com\",\n        plan: \"free\",\n        stripeSubscriptionStatus: null,\n        stripeCancelAtPeriodEnd: null,\n        stripeCurrentPeriodEnd: null,\n      },\n    ]);\n    const userFromSpy = vi.fn(() => ({ where: userWhereSpy }));\n\n    selectSpy = vi\n      .fn()\n      .mockImplementationOnce(() => ({ from: sessionFromSpy }))\n      .mockImplementationOnce(() => ({ from: userFromSpy }));\n\n    const { default: SettingsPage } = await import(\"../app/(dashboard)/settings/page\");\n\n    const element = await SettingsPage();\n    const html = renderToStaticMarkup(element);\n\n    expect(html).toContain(\"Account settings\");\n    expect(html).toContain(\"u1@example.com\");\n    expect(html).toContain(\"Free\"); // Plan is capitalized\n    expect(html).toContain('action=\"/api/stripe/checkout\"');\n    // Logout form was removed from bottom; only appears in top-right nav\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-checkout-additional.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-checkout-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-client.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-env-example.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-migration.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-plans.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-portal-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-reconcile-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-webhook-api.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/stripe-webhook-handlers.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-client.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-daily-aggregates.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-events-datasource.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-live-feed.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-page-views-timeseries.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-sql-client.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-top-pages.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/tinybird-top-referrers.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/user-dropdown.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/tests/users-queries.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/types/database.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/types/github.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/coding/Projects/fast_pr_analytics/apps/web/vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
